<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
  "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><link rel="stylesheet" type="text/css" href="../style.css"/><script src="../permalink.js"/><script src="../navigation.js"/><title>Well-specified Common Lisp — HASH-TABLE-SIZE</title></head><body><main><nav class="sidebar"><span class="name">Entry Points</span><br/><ol><li><a href="../chap-0.xhtml#section-Figures">Table of Contents</a></li><li><a href="../symbol-index.xhtml#section-SymbolIndex">Symbol Index</a></li><li><a href="../figure-index.xhtml#section-FigureIndex">Figure Index</a></li><li><a href="../issue-index.xhtml#section-IssueIndices">Issue Index</a></li><li><a href="../note-indices.xhtml#section-ReviewerNoteIndex">Note Indices</a></li><li><a href="../chapter-26.xhtml#section-Glossary">Glossary</a></li></ol><hr/><span class="name">HASH-TABLE-SIZE</span><br/><ol class="local-toc"><li><a href="#section-Status">Status</a><ol> </ol></li><li><a href="#section-References">References</a><ol> </ol></li><li><a href="#section-Edit history">Edit history</a><ol> </ol></li><li><a href="#section-Problem description">Problem description</a><ol> </ol></li><li><a href="#issue-hash-table-size:intended-entries">Proposal INTENDED-ENTRIES</a><ol> </ol></li><li><a href="#section-Rationale">Rationale</a><ol> </ol></li><li><a href="#section-Current practice">Current practice</a><ol> </ol></li><li><a href="#section-Cost to Implementors">Cost to Implementors</a><ol> </ol></li><li><a href="#section-Cost to Users">Cost to Users</a><ol> </ol></li><li><a href="#section-Cost of non-adoption">Cost of non-adoption</a><ol> </ol></li><li><a href="#section-Performance impact">Performance impact</a><ol> </ol></li><li><a href="#section-Benefits/Esthetics">Benefits/Esthetics</a><ol> </ol></li><li><a href="#section-Discussion">Discussion</a><ol> </ol></li></ol></nav><div class="content"><h1>X3J13 Issue HASH-TABLE-SIZE [NIL] [CLARIFICATION]</h1><section id="section-Status" class="status-passed section"><h2 class="section-title">Status</h2>Passed, as amended here, Jun 89 X3J13 </section><section id="section-References" class="section"><h2 class="section-title">References</h2>CLtL p.283 </section><section id="section-Edit history" class="section"><h2 class="section-title">Edit history</h2>Version 1, 20-Mar-89, by Moon Version 2, 1-Jul-89, by Masinter (per Jun89 X3J13 amendments) </section><section id="section-Problem description" class="section"><h2 class="section-title">Problem description</h2>  CLtL contradicts itself on the meaning of the :SIZE argument to   <a class="function-reference" href="../chapter-18.xhtml#function-make-hash-table">make-hash-table</a>.  At the top of p.283, it says that the size is "the   maximum number of entries it can hold.  Usually the actual capacity of   the table is somewhat less."  At the bottom of the page it says "this   argument serves as a hint to the implementation of approximately how   many entries you intend to store."  So does the :SIZE intended to be the   actual capacity of the table, or the amount of storage allocated to hold   the table.  For example, if the implementation of hash tables is   designed for a loading of 65%, and the user specifies :SIZE 100, does   the table returned have space allocated for 100 entries, so that it   overflows and becomes bigger when 65 entries are inserted, or does the   table have space allocated for 154 entries, so that it overflows and   becomes bigger when 100 entries are inserted? <br/></section><section class="status-passed proposal" id="issue-hash-table-size:intended-entries"><h2 class="section-title">Proposal INTENDED-ENTRIES</h2>  Believe the bottom of p.283 rather than the top.  The :SIZE argument   is approximately the number of entries that can be inserted without   the table having to grow. <br/>  Keep the first and last sentences of the definition of :REHASH-THRESHOLD   (CLtL p. 284.) Replace the rest with:   "This can be a <a class="type-reference" href="../chapter-12.xhtml#type-real">real</a> between 0 and 1, inclusive, which is a hint to the   implementation of the maximum desired hash table occupancy level. An   implementation is permitted to ignore this argument." <br/>Editorial consequences:   Remove the second complete paragraph of CLtL p. 283. It's too implementa<a class="function-reference" href="../chapter-12.xhtml#function--">-</a>   tion-dependent. Clarify the implementation is not necessarily an actual   hash table of any particular hashing technique. <br/></section><section id="section-Rationale" class="section"><h2 class="section-title">Rationale</h2>  The bottom of p.283 is user-oriented, the top is implementation-oriented.   User-oriented seems more appropriate. <br/></section><section id="section-Current practice" class="section"><h2 class="section-title">Current practice</h2>  Symbolics Genera 7.4 adheres to <a class="issue-reference" href="#issue-hash-table-size:intended-entries">HASH-TABLE-SIZE:INTENDED-ENTRIES</a>.   Other implementations were not surveyed. <br/></section><section id="section-Cost to Implementors" class="section"><h2 class="section-title">Cost to Implementors</h2>  At worst adding a multiplication to <a class="function-reference" href="../chapter-18.xhtml#function-make-hash-table">make-hash-table</a>. <br/></section><section id="section-Cost to Users" class="section"><h2 class="section-title">Cost to Users</h2>  Probably none, but it is hard to predict. <br/></section><section id="section-Cost of non-adoption" class="section"><h2 class="section-title">Cost of non-adoption</h2>  Implementations will probably vary in which of the two interpretations   they believe.  The language standard will not be self-consistent. <br/></section><section id="section-Performance impact" class="section"><h2 class="section-title">Performance impact</h2>  None of any significance. <br/></section><section id="section-Benefits/Esthetics" class="section"><h2 class="section-title">Benefits/Esthetics</h2>  More self-consistent language. <br/></section><section id="section-Discussion" class="section"><h2 class="section-title">Discussion</h2>  None. </section></div></main><footer>Copyright © 2021 Jan Moringen</footer></body></html>