<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
  "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><link rel="stylesheet" type="text/css" href="../style.css"/><script src="../permalink.js"/><script src="../navigation.js"/><title>Well-specified Common Lisp — STRING-COERCION</title></head><body><main><nav class="sidebar"><span class="name">Entry Points</span><br/><ol><li><a href="../chap-0.xhtml#section-Figures">Table of Contents</a></li><li><a href="../symbol-index.xhtml#section-SymbolIndex">Symbol Index</a></li><li><a href="../figure-index.xhtml#section-FigureIndex">Figure Index</a></li><li><a href="../issue-index.xhtml#section-IssueIndices">Issue Index</a></li><li><a href="../note-indices.xhtml#section-ReviewerNoteIndex">Note Indices</a></li><li><a href="../chapter-26.xhtml#section-Glossary">Glossary</a></li></ol><hr/><span class="name">STRING-COERCION</span><br/><ol class="local-toc"><li><a href="#section-Status">Status</a><ol> </ol></li><li><a href="#section-References">References</a><ol> </ol></li><li><a href="#section-Edit history">Edit history</a><ol> </ol></li><li><a href="#section-Problem description">Problem description</a><ol> </ol></li><li><a href="#issue-string-coercion:make-consistent">Proposal MAKE-CONSISTENT</a><ol> </ol></li><li><a href="#section-Examples">Examples</a><ol> </ol></li><li><a href="#section-Rationale">Rationale</a><ol> </ol></li><li><a href="#section-Current practice">Current practice</a><ol> </ol></li><li><a href="#section-Cost to Implementors">Cost to Implementors</a><ol> </ol></li><li><a href="#section-Cost to Users">Cost to Users</a><ol> </ol></li><li><a href="#section-Cost of non-adoption">Cost of non-adoption</a><ol> </ol></li><li><a href="#section-Performance impact">Performance impact</a><ol> </ol></li><li><a href="#section-Benefits">Benefits</a><ol> </ol></li><li><a href="#section-Esthetics">Esthetics</a><ol> </ol></li><li><a href="#section-Discussion">Discussion</a><ol> </ol></li></ol></nav><div class="content"><h1>X3J13 Issue STRING-COERCION [NIL] [CLARIFICATION]</h1><section id="section-Status" class="status-passed section"><h2 class="section-title">Status</h2>Passed, Jun 89 X3J13 </section><section id="section-References" class="section"><h2 class="section-title">References</h2>Strings (pp299-304), <a class="function-reference" href="../chapter-16.xhtml#function-string=">string=</a> (p300), <a class="function-reference" href="../chapter-16.xhtml#function-string-equal">string-equal</a> (p301), <a class="function-reference" href="../chapter-16.xhtml#function-string">string</a>&lt; (p301), <a class="function-reference" href="../chapter-16.xhtml#function-string">string</a>&gt; (p301), <a class="function-reference" href="../chapter-16.xhtml#function-string">string</a>&lt;<a class="function-reference" href="../chapter-12.xhtml#function-=">=</a> (p301), <a class="function-reference" href="../chapter-16.xhtml#function-string">string</a>&gt;<a class="function-reference" href="../chapter-12.xhtml#function-=">=</a> (p301), <a class="function-reference" href="../chapter-16.xhtml#function-string/=">string/=</a> (p301), <a class="function-reference" href="../chapter-16.xhtml#function-string-lessp">string-lessp</a> (p302), <a class="function-reference" href="../chapter-16.xhtml#function-string-greaterp">string-greaterp</a> (p302), <a class="function-reference" href="../chapter-16.xhtml#function-string-not-greaterp">string-not-greaterp</a> (p302), <a class="function-reference" href="../chapter-16.xhtml#function-string-not-lessp">string-not-lessp</a> (p302), <a class="function-reference" href="../chapter-16.xhtml#function-string-not-equal">string-not-equal</a> (p302), <a class="function-reference" href="../chapter-16.xhtml#function-string-trim">string-trim</a> (p302), <a class="function-reference" href="../chapter-16.xhtml#function-string-left-trim">string-left-trim</a> (p302), <a class="function-reference" href="../chapter-16.xhtml#function-string-right-trim">string-right-trim</a> (p302), <a class="function-reference" href="../chapter-16.xhtml#function-string-upcase">string-upcase</a> (p303), <a class="function-reference" href="../chapter-16.xhtml#function-string-downcase">string-downcase</a> (p303), and <a class="function-reference" href="../chapter-16.xhtml#function-string-capitalize">string-capitalize</a> (p303). </section><section id="section-Edit history" class="section"><h2 class="section-title">Edit history</h2>Version 1, 9-May-89 by Moon Version 2, 9-May-89 by Pitman (editorial changes) </section><section id="section-Problem description" class="section"><h2 class="section-title">Problem description</h2>  CLtL is inconsistent about the argument coercion performed by the   referenced functions. Page 299 says that the &lt;string&gt; argument can   be either a symbol or a string.  Page 304 says that these functions   effectively call the <a class="function-reference" href="../chapter-16.xhtml#function-string">string</a> function, thus accepting a symbol,   a string, or a character. <br/>  Neither page lists the set of affected functions explicitly. <br/>  Page 304 says that if any other data type is used, an error is   signalled.  But some implementations allow other types, such as   pathnames, to be coerced to strings, which page 299 appears to allow   but page 304 appears to forbid.  In some implementations these   coercions are under user control via methods for a generic function. <br/></section><section class="status-passed proposal" id="issue-string-coercion:make-consistent"><h2 class="section-title">Proposal MAKE-CONSISTENT</h2>  Specify that the referenced functions perform coercion identical to   the action of the <a class="function-reference" href="../chapter-16.xhtml#function-string">string</a> function. <br/>  Specify that the <a class="function-reference" href="../chapter-16.xhtml#function-string">string</a> function can perform additional implementation   dependent coercions.  In all cases the returned value is of type <a class="function-reference" href="../chapter-16.xhtml#function-string">string</a>.   Only in the case where no coercion is defined is the <a class="function-reference" href="../chapter-16.xhtml#function-string">string</a> function   required to signal an error; in that case, the error is of type <a class="type-reference" href="../chapter-4.xhtml#type-type-error">type-error</a>. <br/></section><section id="section-Examples" class="section"><h2 class="section-title">Examples</h2><pre>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-16.xhtml#function-string-lessp">string-lessp</a> <span class="syntax-character">#\a</span> <span class="syntax-string">"B"</span>)</span>
</span></code></pre> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a><br/><br/></pre></section><section id="section-Rationale" class="section"><h2 class="section-title">Rationale</h2>  Our choices are to make the coercion identical to the <a class="function-reference" href="../chapter-16.xhtml#function-string">string</a> function,   identical to the <a class="function-reference" href="../chapter-4.xhtml#function-coerce">coerce</a> function, or different from both of them.  The   <a class="function-reference" href="../chapter-4.xhtml#function-coerce">coerce</a> function won't coerce non-null symbols to strings, so it is out.   Being consistent with the <a class="function-reference" href="../chapter-16.xhtml#function-string">string</a> function seems better than inventing   yet another set of string coercion rules.  Removing the ability for the   <a class="function-reference" href="../chapter-16.xhtml#function-string">string</a> function to coerce characters to strings would be an incompatible   change, so instead we clarify that the other functions have that ability. <br/>  Allowing additional coercions is harmless and consistent with current   practice. <br/></section><section id="section-Current practice" class="section"><h2 class="section-title">Current practice</h2>  Symbolics Genera follows page 304 except for allowing additional   coercions.  Symbolics Cloe follows page 299 except for not allowing   additional coercions. <br/></section><section id="section-Cost to Implementors" class="section"><h2 class="section-title">Cost to Implementors</h2>  Small changes to eighteen functions. <br/></section><section id="section-Cost to Users" class="section"><h2 class="section-title">Cost to Users</h2>  None, this is upward-compatible. <br/></section><section id="section-Cost of non-adoption" class="section"><h2 class="section-title">Cost of non-adoption</h2>  Inconsistency and confusion about what coercions are allowed. <br/></section><section id="section-Performance impact" class="section"><h2 class="section-title">Performance impact</h2>  None.  If these things have to accept symbols, accepting characters   too can't make much difference.  The implementation of character   arguments to string functions might cons a string, but this has no   performance impact on programs that don't use the feature. <br/></section><section id="section-Benefits" class="section"><h2 class="section-title">Benefits</h2>  Consistency. <br/></section><section id="section-Esthetics" class="section"><h2 class="section-title">Esthetics</h2>  Consistency. <br/></section><section id="section-Discussion" class="section"><h2 class="section-title">Discussion</h2>  None. </section></div></main><footer>Copyright © 2021 Jan Moringen</footer></body></html>