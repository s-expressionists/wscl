<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
  "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><link rel="stylesheet" type="text/css" href="../style.css"/><script src="../permalink.js"/><script src="../navigation.js"/><title>Well-specified Common Lisp — COMPLEX-ATAN-BRANCH-CUT</title></head><body><main><nav class="sidebar"><span class="name">Entry Points</span><br/><ol><li><a href="../chap-0.xhtml#section-Figures">Table of Contents</a></li><li><a href="../symbol-index.xhtml#section-SymbolIndex">Symbol Index</a></li><li><a href="../figure-index.xhtml#section-FigureIndex">Figure Index</a></li><li><a href="../issue-index.xhtml#section-IssueIndices">Issue Index</a></li><li><a href="../note-indices.xhtml#section-ReviewerNoteIndex">Note Indices</a></li><li><a href="../chapter-26.xhtml#section-Glossary">Glossary</a></li></ol><hr/><span class="name">COMPLEX-ATAN-BRANCH-CUT</span><br/><ol class="local-toc"><li><a href="#section-Status">Status</a><ol> </ol></li><li><a href="#section-References">References</a><ol> </ol></li><li><a href="#section-Edit history">Edit history</a><ol> </ol></li><li><a href="#section-Problem description">Problem description</a><ol> </ol></li><li><a href="#issue-complex-atan-branch-cut:tweak">Proposal TWEAK</a><ol> </ol></li><li><a href="#section-Examples">Examples</a><ol> </ol></li><li><a href="#section-Note">Note</a><ol> </ol></li><li><a href="#section-Rationale">Rationale</a><ol> </ol></li><li><a href="#section-Current practice">Current practice</a><ol> </ol></li><li><a href="#section-Cost to Implementors">Cost to Implementors</a><ol> </ol></li><li><a href="#section-Cost to Users">Cost to Users</a><ol> </ol></li><li><a href="#section-Cost of non-adoption">Cost of non-adoption</a><ol> </ol></li><li><a href="#section-Benefits">Benefits</a><ol> </ol></li><li><a href="#section-Esthetics">Esthetics</a><ol> </ol></li><li><a href="#section-Discussion">Discussion</a><ol> </ol></li></ol></nav><div class="content"><h1>X3J13 Issue COMPLEX-ATAN-BRANCH-CUT [Cleanup] [CHANGE]</h1><h2>Related issues</h2><ul><a class="issue-reference" href="../issues/ieee-atan-branch-cut.xhtml#issue-ieee-atan-branch-cut">IEEE-ATAN-BRANCH-CUT</a></ul><section id="section-Status" class="status-passed section"><h2 class="section-title">Status</h2>Passed, Jan 89 X3J13 </section><section id="section-References" class="section"><h2 class="section-title">References</h2>CLtL p.208, 212 </section><section id="section-Edit history" class="section"><h2 class="section-title">Edit history</h2>Version 1, 13-Dec-88, Steele </section><section id="section-Problem description" class="section"><h2 class="section-title">Problem description</h2>The formula that defines <a class="function-reference" href="../chapter-12.xhtml#function-atan">atan</a> results in a branch cut that is at variance with the recommendations of Prof. W. Kahan and with the implementations of that function in many computing systems and calculators. <br/></section><section class="status-passed proposal" id="issue-complex-atan-branch-cut:tweak"><h2 class="section-title">Proposal TWEAK</h2>Replace the formula <br/>	arctan z <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a> <a class="function-reference" href="../chapter-12.xhtml#function--">-</a> i log <code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-cons">(<span class="syntax-interned-symbol">1+iz</span>)</span> <a class="function-reference" href="../chapter-12.xhtml#function-sqrt">sqrt</a> <span class="syntax-cons">(<span class="syntax-interned-symbol">1/</span><span class="syntax-cons">(<span class="syntax-interned-symbol">1+z^2</span>)</span>)</span>)</span>
</span></code> <br/>with the formula <br/>	arctan z <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a> <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-12.xhtml#function-log">log</a> <span class="syntax-cons">(<span class="syntax-interned-symbol">1+iz</span>)</span> <a class="function-reference" href="../chapter-12.xhtml#function--">-</a> <a class="function-reference" href="../chapter-12.xhtml#function-log">log</a> <span class="syntax-cons">(<span class="syntax-interned-symbol">1-iz</span>)</span>)</span>
</span></code> <a class="function-reference" href="../chapter-12.xhtml#function-/">/</a> <code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">2i</span>)</span>
</span></code> <br/>This leaves the branch cuts pretty much in place; the only change is that the upper branch cut <code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">on</span> <a class="special-operator-reference" href="../chapter-3.xhtml#special-operator-the">the</a> <span class="syntax-interned-symbol">positive</span> <span class="syntax-interned-symbol">imaginary</span> <span class="syntax-interned-symbol">axis</span> <span class="syntax-interned-symbol">above</span> <span class="syntax-interned-symbol">i</span>)</span>
</span></code> is continuous with quadrant I, where the old formula has it continuous with quadrant II. <br/></section><section id="section-Examples" class="section"><h2 class="section-title">Examples</h2><pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-12.xhtml#function-atan">atan</a> <span class="syntax-number">#c<span class="syntax-symbol">(<span class="syntax-number">0</span> <span class="syntax-number">2</span>)</span></span>)</span>
</span></code> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; #c<code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">-1.57...</span> <span class="syntax-interned-symbol">0.549...</span>)</span>
</span></code>	;Current<br/><code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-12.xhtml#function-atan">atan</a> <span class="syntax-number">#c<span class="syntax-symbol">(<span class="syntax-number">0</span> <span class="syntax-number">2</span>)</span></span>)</span>
</span></code> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; #c<code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">1.57...</span> <span class="syntax-interned-symbol">-0.549...</span>)</span>
</span></code>	;Proposed<br/><br/></pre></section><section id="section-Note" class="section"><h2 class="section-title">Note</h2>1.57... <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a> pi/2, and 0.549... <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a> <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-12.xhtml#function-log">log</a> <span class="syntax-number">3</span>)</span>
</span></code>/2. </section><section id="section-Rationale" class="section"><h2 class="section-title">Rationale</h2>Compatibility with what seems to be becoming standard practice. <br/>   </section><section id="section-Current practice" class="section"><h2 class="section-title">Current practice</h2><code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-12.xhtml#function-atan">atan</a> <span class="syntax-number">#c<span class="syntax-symbol">(<span class="syntax-number">0</span> <span class="syntax-number">2</span>)</span></span>)</span>
</span></code> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; #c<code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">-1.57...</span> <span class="syntax-interned-symbol">0.549...</span>)</span>
</span></code>	;Symbolics <a class="package-reference" href="../chapter-11.xhtml#package-cl">cl</a> <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-12.xhtml#function-atan">atan</a> <span class="syntax-number">#c<span class="syntax-symbol">(<span class="syntax-number">0</span> <span class="syntax-number">2</span>)</span></span>)</span>
</span></code> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; #c<code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">-1.57...</span> <span class="syntax-interned-symbol">0.549...</span>)</span>
</span></code>	;Allegro <a class="package-reference" href="../chapter-11.xhtml#package-cl">cl</a> 1.1 (Macintosh) <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-12.xhtml#function-atan">atan</a> <span class="syntax-number">#c<span class="syntax-symbol">(<span class="syntax-number">0</span> <span class="syntax-number">2</span>)</span></span>)</span>
</span></code> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; #c<code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">-1.57...</span> <span class="syntax-interned-symbol">0.549...</span>)</span>
</span></code>	;Sun-4 <a class="package-reference" href="../chapter-11.xhtml#package-cl">cl</a> 2.1.3 of 10-Nov-88 <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-12.xhtml#function-atan">atan</a> <span class="syntax-number">#c<span class="syntax-symbol">(<span class="syntax-number">0</span> <span class="syntax-number">2</span>)</span></span>)</span>
</span></code> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; #c<code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">1.57...</span> <span class="syntax-interned-symbol">-0.549...</span>)</span>
</span></code>	;Sun <a class="package-reference" href="../chapter-11.xhtml#package-cl">cl</a> 2.0.3 of 30-Jun-87 <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-12.xhtml#function-atan">atan</a> <span class="syntax-number">#c<span class="syntax-symbol">(<span class="syntax-number">0</span> <span class="syntax-number">2</span>)</span></span>)</span>
</span></code> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; #c<code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">1.57...</span> <span class="syntax-interned-symbol">0.549...</span>)</span>
</span></code>	;KCL of 3-Jun-87 <br/>Note that in KCL the upper branch cut is thus continuous with quadrant I, but its lower branch cut is continuous with quadrant III! <br/></section><section id="section-Cost to Implementors" class="section"><h2 class="section-title">Cost to Implementors</h2><a class="function-reference" href="../chapter-12.xhtml#function-atan">atan</a> must be rewritten.  It is not a very difficult fix. <br/></section><section id="section-Cost to Users" class="section"><h2 class="section-title">Cost to Users</h2>It is barely conceivable that some user code could depend on this. Note that the proposed change invalidates the identities 	arctan i z <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a> i arctanh z and	arctanh i z <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a> i arctan z on the upper branch cut. <br/>The compatibility note on p. 210 of CLtL gave users fair warning that a change of this kind might be adopted. <br/></section><section id="section-Cost of non-adoption" class="section"><h2 class="section-title">Cost of non-adoption</h2>Incompatibility with HP calculators. <br/></section><section id="section-Benefits" class="section"><h2 class="section-title">Benefits</h2>Numerical analystsmay find the new definition easier to use. <br/></section><section id="section-Esthetics" class="section"><h2 class="section-title">Esthetics</h2>A toss-up, except to those who care. <br/></section><section id="section-Discussion" class="section"><h2 class="section-title">Discussion</h2>Steele has sent a letter to W. Kahan at Berkeley to get any last comments he may have on the matter. <br/>Paul Penfield of MIT, after whose article the Common Lisp branch cuts were originally patterned, endorses this change. </section></div></main><footer>Copyright © 2021 Jan Moringen</footer></body></html>