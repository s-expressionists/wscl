<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
  "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><link rel="stylesheet" type="text/css" href="../style.css"/><script src="../permalink.js"/><script src="../navigation.js"/><title>Well-specified Common Lisp — PATHNAME-STREAM</title></head><body><main><nav class="sidebar"><span class="name">Entry Points</span><br/><ol><li><a href="../chap-0.xhtml#section-Figures">Table of Contents</a></li><li><a href="../symbol-index.xhtml#section-SymbolIndex">Symbol Index</a></li><li><a href="../figure-index.xhtml#section-FigureIndex">Figure Index</a></li><li><a href="../issue-index.xhtml#section-IssueIndices">Issue Index</a></li><li><a href="../note-indices.xhtml#section-ReviewerNoteIndex">Note Indices</a></li><li><a href="../chapter-26.xhtml#section-Glossary">Glossary</a></li></ol><hr/><span class="name">PATHNAME-STREAM</span><br/><ol class="local-toc"><li><a href="#section-References">References</a><ol> </ol></li><li><a href="#section-Edit History">Edit History</a><ol> </ol></li><li><a href="#section-Problem Description">Problem Description</a><ol> </ol></li><li><a href="#issue-pathname-stream:files-or-synonym">Proposal FILES-OR-SYNONYM</a><ol> </ol></li><li><a href="#section-Rationale">Rationale</a><ol> </ol></li><li><a href="#section-Current Practice">Current Practice</a><ol> </ol></li><li><a href="#section-Adoption Cost">Adoption Cost</a><ol> </ol></li><li><a href="#section-Benefits">Benefits</a><ol> </ol></li><li><a href="#section-Conversion Cost">Conversion Cost</a><ol> </ol></li><li><a href="#section-Aesthetics">Aesthetics</a><ol> </ol></li><li><a href="#section-Discussion">Discussion</a><ol> </ol></li></ol></nav><div class="content"><h1>X3J13 Issue PATHNAME-STREAM [NIL] [CHANGE/CLARIFICATION]</h1><section id="section-References" class="section"><h2 class="section-title">References</h2><a class="function-reference" href="../chapter-19.xhtml#function-pathname">pathname</a> (p.413), also the introductory text right above it on the same page. Derived references: <a class="function-reference" href="../chapter-20.xhtml#function-truename">truename</a> (p.413), <a class="function-reference" href="../chapter-19.xhtml#function-parse-namestring">parse-namestring</a> (p.414), <a class="function-reference" href="../chapter-19.xhtml#function-merge-pathnames">merge-pathnames</a> (p.415), <a class="function-reference" href="../chapter-19.xhtml#function-pathname-host">pathname-host</a> etc. (p.417), <a class="function-reference" href="../chapter-21.xhtml#function-open">open</a> (p.418), <a class="macro-reference" href="../chapter-21.xhtml#macro-with-open-file">with-open-file</a> (p.422), <a class="function-reference" href="../chapter-20.xhtml#function-rename-file">rename-file</a> (p.423), <a class="function-reference" href="../chapter-20.xhtml#function-delete-file">delete-file</a> (p.424) </section><section id="section-Edit History" class="section"><h2 class="section-title">Edit History</h2>Version 1 by Moon 11-May-87 Version 2 by Masinter 29-May-87 (minor editing) Version 3 by Masinter 11-Jun-87 (minor editing) Version 4 by Masinter  8-Oct-87 (rewording) Version 5 by Masinter  8-Oct-87 (explicitly only open) Version 6 by Masinter 14-Nov-87 </section><section id="section-Problem Description" class="section"><h2 class="section-title">Problem Description</h2>CLtL says that a stream can be used as an argument and converted to a pathname, but many sources or sinks of data that streams might be connected to have no pathnames associated with them; for example, streams created with <a class="function-reference" href="../chapter-21.xhtml#function-make-two-way-stream">make-two-way-stream</a> or OPEN-STRING-STREAM. For many such streams, there is no simple way to coerce such a stream to a pathname. <br/></section><section class="status-unknown proposal" id="issue-pathname-stream:files-or-synonym"><h2 class="section-title">Proposal FILES-OR-SYNONYM</h2>Clarify that the use of a stream as an argument that expects a pathname (as described on p413 of CLtL) only applies to streams that are originally opened by use of the <a class="function-reference" href="../chapter-21.xhtml#function-open">open</a> or <a class="macro-reference" href="../chapter-21.xhtml#macro-with-open-file">with-open-file</a>, or to synonym streams whose symbol is bound to such a stream. It is an error to attempt to obtain a pathname from a stream created with <a class="function-reference" href="../chapter-21.xhtml#function-make-two-way-stream">make-two-way-stream</a>, OPEN-STRING-STREAM, <a class="function-reference" href="../chapter-21.xhtml#function-make-echo-stream">make-echo-stream</a>, <a class="function-reference" href="../chapter-21.xhtml#function-make-broadcast-stream">make-broadcast-stream</a>, <a class="function-reference" href="../chapter-21.xhtml#function-make-concatenated-stream">make-concatenated-stream</a>, <a class="function-reference" href="../chapter-21.xhtml#function-make-string-input-stream">make-string-input-stream</a>, <a class="function-reference" href="../chapter-21.xhtml#function-make-string-output-stream">make-string-output-stream</a>. <br/>The pathname used represents the name used to open the file. This may be, but is not required to be, the actual name of the file. The pathname used is the same as would be returned by the <a class="function-reference" href="../chapter-19.xhtml#function-pathname">pathname</a> function. <br/></section><section id="section-Rationale" class="section"><h2 class="section-title">Rationale</h2>This is probably what the designers of Common Lisp intended. This is the only thing that can be implemented without large changes to the language such as extending pathnames to things other than files.  <br/></section><section id="section-Current Practice" class="section"><h2 class="section-title">Current Practice</h2>Some systems signal an error if a non-file stream is used as a pathname. Others return an empty pathname. <br/>Some implementations do not return a meaningful value for <a class="function-reference" href="../chapter-19.xhtml#function-pathname">pathname</a> of a synonym stream. <br/></section><section id="section-Adoption Cost" class="section"><h2 class="section-title">Adoption Cost</h2>Implementations that do not currently handle <a class="function-reference" href="../chapter-19.xhtml#function-pathname">pathname</a> of a synonym stream will have to change to allow it. Otherwise, since the proposal says only "is an error" rather than "signals an error", no implementations other changes are necessary. <br/></section><section id="section-Benefits" class="section"><h2 class="section-title">Benefits</h2>The description of pathname functions will make more sense. <br/></section><section id="section-Conversion Cost" class="section"><h2 class="section-title">Conversion Cost</h2>Small: Users with code which accesses pathname components of streams in implementations which allow it might need to change their programs to make them portable. <br/></section><section id="section-Aesthetics" class="section"><h2 class="section-title">Aesthetics</h2>Makes language a little cleaner. <br/></section><section id="section-Discussion" class="section"><h2 class="section-title">Discussion</h2>The only point of disagreement on this proposal has been on the issue of whether <a class="function-reference" href="../chapter-19.xhtml#function-pathname">pathname</a> applies to synonym streams and returns the pathname of the stream designated.  <br/>This version of the proposal says yes, because CLtL p 329 says about synonym streams that  "Any operations on the new stream ..." and does not say anything about exceptions; earlier on the page the phrase "synonym streams that pass all operations on" is used.  This seems fairly unambiguous, although the word "operations" is not defined. There was a similar controversy about what <a class="function-reference" href="../chapter-21.xhtml#function-close">close</a> of a synonym stream means. <br/>Note that there is currently no way portable to determine whether a stream has a pathname available.  <br/>The entire <a class="function-reference" href="../chapter-19.xhtml#function-pathname">pathname</a> section needs work to clarify the intent and enable portable code. This is just a minor issue among the major ones. <br/></section></div></main><footer>Copyright © 2021 Jan Moringen</footer></body></html>