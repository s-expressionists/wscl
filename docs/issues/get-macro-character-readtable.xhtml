<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
  "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><link rel="stylesheet" type="text/css" href="../style.css"/><script src="../permalink.js"/><script src="../navigation.js"/><title>Well-specified Common Lisp — GET-MACRO-CHARACTER-READTABLE</title></head><body><main><nav class="sidebar"><span class="name">Entry Points</span><br/><ol><li><a href="../chap-0.xhtml#section-Figures">Table of Contents</a></li><li><a href="../symbol-index.xhtml#section-SymbolIndex">Symbol Index</a></li><li><a href="../figure-index.xhtml#section-FigureIndex">Figure Index</a></li><li><a href="../issue-index.xhtml#section-IssueIndices">Issue Index</a></li><li><a href="../note-indices.xhtml#section-ReviewerNoteIndex">Note Indices</a></li><li><a href="../chapter-26.xhtml#section-Glossary">Glossary</a></li></ol><hr/><span class="name">GET-MACRO-CHARACTER-READTABLE</span><br/><ol class="local-toc"><li><a href="#section-Status">Status</a><ol> </ol></li><li><a href="#section-References">References</a><ol> </ol></li><li><a href="#section-Edit history">Edit history</a><ol> </ol></li><li><a href="#section-Problem description">Problem description</a><ol> </ol></li><li><a href="#issue-get-macro-character-readtable:nil-standard">Proposal NIL-STANDARD</a><ol> </ol></li><li><a href="#section-Rationale">Rationale</a><ol> </ol></li><li><a href="#section-Current practice">Current practice</a><ol> </ol></li><li><a href="#section-Cost to Implementors">Cost to Implementors</a><ol> </ol></li><li><a href="#section-Cost to Users">Cost to Users</a><ol> </ol></li><li><a href="#section-Cost of non-adoption">Cost of non-adoption</a><ol> </ol></li><li><a href="#section-Performance impact">Performance impact</a><ol> </ol></li><li><a href="#section-Benefits">Benefits</a><ol> </ol></li><li><a href="#section-Esthetics">Esthetics</a><ol> </ol></li><li><a href="#section-Discussion">Discussion</a><ol> </ol></li><li><a href="#section-test case because of problems of &quot;function equivalence&quot;">test case because of problems of "function equivalence"</a><ol> </ol></li></ol></nav><div class="content"><h1>X3J13 Issue GET-MACRO-CHARACTER-READTABLE [Cleanup] [CLARIFICATION/CHANGE]</h1><section id="section-Status" class="status-passed section"><h2 class="section-title">Status</h2>Passed, Jan 89 X3J13 </section><section id="section-References" class="section"><h2 class="section-title">References</h2>CLtL p.361: <a class="function-reference" href="../chapter-23.xhtml#function-copy-readtable">copy-readtable</a>, <a class="function-reference" href="../chapter-23.xhtml#function-set-syntax-from-char">set-syntax-from-char</a>, and <a class="function-reference" href="../chapter-23.xhtml#function-get-macro-character">get-macro-character</a> CLtL p.364: <a class="function-reference" href="../chapter-23.xhtml#function-get-dispatch-macro-character">get-dispatch-macro-character</a>,  CLtL p.378: Example in middle of page </section><section id="section-Edit history" class="section"><h2 class="section-title">Edit history</h2>Version 1, 16-Nov-88, by JonL Version 2,  8-Dec-88, by Masinter (fix typo) Version 3, 11-Feb-89, as amended Jan 89 X3J13 <br/></section><section id="section-Problem description" class="section"><h2 class="section-title">Problem description</h2>The 'readtable' argument to <a class="function-reference" href="../chapter-23.xhtml#function-get-dispatch-macro-character">get-dispatch-macro-character</a> and to <a class="function-reference" href="../chapter-23.xhtml#function-get-macro-character">get-macro-character</a> must be of type <a class="type-reference" href="../chapter-23.xhtml#type-readtable">readtable</a>, without mention of what happens when <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a> is supplied. This may have been simply an oversight, since it makes more sense for it to refer to values from the standard readtable.  Both <a class="function-reference" href="../chapter-23.xhtml#function-copy-readtable">copy-readtable</a> and <a class="function-reference" href="../chapter-23.xhtml#function-set-syntax-from-char">set-syntax-from-char</a> explicitly say that a <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a> in the 'from-readtable' argument refers to the standard readtable.  Also, an example in the middle of the page, CLtL p.378, supplies a <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a> to <a class="function-reference" href="../chapter-23.xhtml#function-get-macro-character">get-macro-character</a>, and is clearly intending to access the standard readtable values. <br/></section><section class="status-passed proposal" id="issue-get-macro-character-readtable:nil-standard"><h2 class="section-title">Proposal NIL-STANDARD</h2>Specify that a <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a> readtable argument to <a class="function-reference" href="../chapter-23.xhtml#function-get-dispatch-macro-character">get-dispatch-macro-character</a> and to <a class="function-reference" href="../chapter-23.xhtml#function-get-macro-character">get-macro-character</a> mean the same thing it does for <a class="function-reference" href="../chapter-23.xhtml#function-copy-readtable">copy-readtable</a>, and <a class="function-reference" href="../chapter-23.xhtml#function-set-syntax-from-char">set-syntax-from-char</a>; namely a reference to the standard readtable.   Thus <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-23.xhtml#function-get-macro-character">get-macro-character</a> <span class="syntax-interned-symbol">&lt;char&gt;</span> <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a>)</span>
</span></code> would be equivalent to  <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-23.xhtml#function-get-macro-character">get-macro-character</a> <span class="syntax-interned-symbol">&lt;char&gt;</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-23.xhtml#function-copy-readtable">copy-readtable</a>)</span>)</span>
</span></code>, but without consing. <br/></section><section id="section-Rationale" class="section"><h2 class="section-title">Rationale</h2>Probably was the original intent; somebody wants it; also see "Esthetics". <br/></section><section id="section-Current practice" class="section"><h2 class="section-title">Current practice</h2>Symbolics and Xerox have already implemented the proposal; Lucid, VAXLISP, and KCL stuck to the more rigid interpretation. <br/></section><section id="section-Cost to Implementors" class="section"><h2 class="section-title">Cost to Implementors</h2>Trivial. <br/></section><section id="section-Cost to Users" class="section"><h2 class="section-title">Cost to Users</h2>None. <br/></section><section id="section-Cost of non-adoption" class="section"><h2 class="section-title">Cost of non-adoption</h2>Minor worry about porting between implementations that support the generalization and those that don't; minor worry about consing when calling <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-23.xhtml#function-copy-readtable">copy-readtable</a>)</span>
</span></code> to get at standard readtable semantics. <br/></section><section id="section-Performance impact" class="section"><h2 class="section-title">Performance impact</h2>See "Cost of non-adoption". <br/></section><section id="section-Benefits" class="section"><h2 class="section-title">Benefits</h2>See "Cost of non-adoption". <br/></section><section id="section-Esthetics" class="section"><h2 class="section-title">Esthetics</h2>Increases parallel design among similar readtable functions. <br/></section><section id="section-Discussion" class="section"><h2 class="section-title">Discussion</h2>This question was raised in the Common Lisp mailing last summer:     Date: 19 Jul 88 <span class="issue-reference error">issue:13:35</span>     Subject: Question about readtable null arguments     From: quiroz%cs.rochester:EDU:Xerox     To: <a class="package-reference" href="../chapter-1.xhtml#package-common-lisp">common-lisp</a>%sail.stanford:EDU:Xerox <br/>This issue passed at the Jan 89 X3J13 meeting. The only difference between version 2 and 3 was to remove the </section><section id="section-test case because of problems of &quot;function equivalence&quot;" class="section"><h2 class="section-title">test case because of problems of "function equivalence"</h2>If "same-function-p" compared functions: <br/><pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-let">let</a> <span class="syntax-cons">(<span class="syntax-cons">(<span class="syntax-interned-symbol">standard-rt</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-23.xhtml#function-copy-readtable">copy-readtable</a>)</span>)</span>
      <span class="syntax-cons">(<span class="syntax-interned-symbol">chars</span> <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-character">#\*</span> <span class="syntax-character">#\=</span> <span class="syntax-character">#\|</span> <span class="syntax-character">#\A</span> <span class="syntax-character">#\ </span> <span class="syntax-character">#\(</span> <span class="syntax-character">#\#</span> <span class="syntax-character">#\1</span>)</span></span>)</span>)</span>
  <span class="syntax-line-comment syntax-comment">;; Test Case 1
</span>  <span class="syntax-cons">(<a class="macro-reference" href="../chapter-6.xhtml#macro-dolist">dolist</a> <span class="syntax-cons">(<a class="function-reference" href="../chapter-16.xhtml#function-char">char</a> <span class="syntax-interned-symbol">chars</span>)</span>
    <span class="syntax-cons">(<a class="macro-reference" href="../chapter-9.xhtml#macro-assert">assert</a> <span class="syntax-cons">(<span class="syntax-interned-symbol">same-function-p</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-23.xhtml#function-get-macro-character">get-macro-character</a> <a class="function-reference" href="../chapter-16.xhtml#function-char">char</a> <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a>)</span>
                <span class="syntax-cons">(<a class="function-reference" href="../chapter-23.xhtml#function-get-macro-character">get-macro-character</a> <a class="function-reference" href="../chapter-16.xhtml#function-char">char</a> <span class="syntax-interned-symbol">standard-rt</span>)</span>)</span>
            <span class="syntax-symbol">()</span> <span class="syntax-string">"Lose on character ~C"</span> <a class="function-reference" href="../chapter-16.xhtml#function-char">char</a>)</span>)</span>
  <span class="syntax-line-comment syntax-comment">;; Test Case 2
</span>  <span class="syntax-cons">(<a class="macro-reference" href="../chapter-6.xhtml#macro-dolist">dolist</a> <span class="syntax-cons">(<a class="function-reference" href="../chapter-16.xhtml#function-char">char</a> <span class="syntax-interned-symbol">chars</span>)</span>
    <span class="syntax-cons">(<a class="macro-reference" href="../chapter-9.xhtml#macro-assert">assert</a> <span class="syntax-cons">(<span class="syntax-interned-symbol">same-function-p</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-23.xhtml#function-get-dispatch-macro-character">get-dispatch-macro-character</a> <span class="syntax-character">#\#</span> <a class="function-reference" href="../chapter-16.xhtml#function-char">char</a> <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a>)</span>
                <span class="syntax-cons">(<a class="function-reference" href="../chapter-23.xhtml#function-get-dispatch-macro-character">get-dispatch-macro-character</a> <span class="syntax-character">#\#</span> <a class="function-reference" href="../chapter-16.xhtml#function-char">char</a> <span class="syntax-interned-symbol">standard-rt</span>)</span>)</span>
            <span class="syntax-symbol">()</span> <span class="syntax-string">"Lose on #\\# dispatch character ~C"</span> <a class="function-reference" href="../chapter-16.xhtml#function-char">char</a>)</span>)</span>
  <span class="syntax-line-comment syntax-comment">;; Test Case 3
</span>  <span class="syntax-cons">(<a class="macro-reference" href="../chapter-9.xhtml#macro-assert">assert</a> <span class="syntax-cons">(<span class="syntax-interned-symbol">same-function-p</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-23.xhtml#function-get-dispatch-macro-character">get-dispatch-macro-character</a> <span class="syntax-character">#\#</span> <span class="syntax-character">#\A</span> <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a>)</span>
              <span class="syntax-cons">(<a class="function-reference" href="../chapter-23.xhtml#function-get-dispatch-macro-character">get-dispatch-macro-character</a> <span class="syntax-character">#\#</span> <span class="syntax-character">#\a</span> <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a>)</span>)</span>
          <span class="syntax-symbol">()</span> <span class="syntax-string">"Lose on #\\# dispatch character ~C"</span> <a class="function-reference" href="../chapter-16.xhtml#function-char">char</a>)</span>
 )</span>
</span></code></pre> <br/></section></div></main><footer>Copyright © 2021 Jan Moringen</footer></body></html>