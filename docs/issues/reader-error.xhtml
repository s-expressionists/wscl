<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
  "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><link rel="stylesheet" type="text/css" href="../style.css"/><script src="../permalink.js"/><script src="../navigation.js"/><title>Well-specified Common Lisp — READER-ERROR</title></head><body><main><nav class="sidebar"><span class="name">Entry Points</span><br/><ol><li><a href="../chap-0.xhtml#section-Figures">Table of Contents</a></li><li><a href="../symbol-index.xhtml#section-SymbolIndex">Symbol Index</a></li><li><a href="../figure-index.xhtml#section-FigureIndex">Figure Index</a></li><li><a href="../issue-index.xhtml#section-IssueIndices">Issue Index</a></li><li><a href="../note-indices.xhtml#section-ReviewerNoteIndex">Note Indices</a></li><li><a href="../chapter-26.xhtml#section-Glossary">Glossary</a></li></ol><hr/><span class="name">READER-ERROR</span><br/><ol class="local-toc"><li><a href="#section-Status">Status</a><ol> </ol></li><li><a href="#section-References">References</a><ol> </ol></li><li><a href="#section-Edit History">Edit History</a><ol> </ol></li><li><a href="#section-Problem Description">Problem Description</a><ol> </ol></li><li><a href="#issue-reader-error:new-type">Proposal NEW-TYPE</a><ol> </ol></li><li><a href="#section-Rationale">Rationale</a><ol> </ol></li><li><a href="#section-Current Practice">Current Practice</a><ol> </ol></li><li><a href="#section-Cost to implementors">Cost to implementors</a><ol> </ol></li><li><a href="#section-Cost to users">Cost to users</a><ol> </ol></li><li><a href="#section-Benefits">Benefits</a><ol> </ol></li><li><a href="#section-Discussion">Discussion</a><ol> </ol></li></ol></nav><div class="content"><h1>X3J13 Issue READER-ERROR [Cleanup] [ADDITION, CHANGE]</h1><section id="section-Status" class="status-passed section"><h2 class="section-title">Status</h2>passed (unanimously) Jun-90 meeting (at which it was amended to rename <a class="type-reference" href="../chapter-23.xhtml#type-reader-error">reader-error</a> to <a class="type-reference" href="../chapter-9.xhtml#type-parse-error">parse-error</a>.) </section><section id="section-References" class="section"><h2 class="section-title">References</h2>Chapter 3, "Syntax" Section 2.2, "Types" </section><section id="section-Edit History" class="section"><h2 class="section-title">Edit History</h2>V1, 23 Oct 1989, Sandra Loosemore V2, 02 Nov 1989, Sandra Loosemore (change supertypes, update discussion) V3, 10 Jul 1990, David Moon (include amendment from meeting) <br/></section><section id="section-Problem Description" class="section"><h2 class="section-title">Problem Description</h2>Chapter 3 of the current draft is not consistent about the types of errors that must be signalled by the reader.  In most places where it specifies that an error is to be signalled, it does not indicate a particular type of error, but in at least one situation it requires the error to be of type <a class="type-reference" href="../chapter-5.xhtml#type-program-error">program-error</a>, and in other cases it requires the error to be of type <a class="function-reference" href="../chapter-9.xhtml#function-error">error</a>. <br/>None of the <a class="function-reference" href="../chapter-9.xhtml#function-error">error</a> subtypes described in section 2.2 really seem appropriate for syntactic errors detected by the reader.  In particular, the description of <a class="type-reference" href="../chapter-5.xhtml#type-program-error">program-error</a> implies that its purpose is for errors relating to program syntax which are detectable during evaluation or compilation rather than read-time errors.  It seems especially inappropriate to use <a class="type-reference" href="../chapter-5.xhtml#type-program-error">program-error</a> for this purpose since the reader can be used to read things other than programs.  Likewise, <a class="type-reference" href="../chapter-21.xhtml#type-stream-error">stream-error</a> appears to have been intended to be used for errors relating to character-level transactions on the stream rather than lexical analysis or parsing. <br/></section><section class="status-passed proposal" id="issue-reader-error:new-type"><h2 class="section-title">Proposal NEW-TYPE</h2>Add a new type specifier, <a class="type-reference" href="../chapter-9.xhtml#type-parse-error">parse-error</a>.  This is a subtype of the types <a class="type-reference" href="../chapter-21.xhtml#type-stream-error">stream-error</a>, <a class="function-reference" href="../chapter-9.xhtml#function-error">error</a>, <a class="type-reference" href="../chapter-9.xhtml#type-serious-condition">serious-condition</a>, <a class="type-reference" href="../chapter-9.xhtml#type-condition">condition</a>, and <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a>.  The type <a class="type-reference" href="../chapter-9.xhtml#type-parse-error">parse-error</a> consists of serious conditions that relate to lexical analysis <code><span class="syntax-root"><span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-3.xhtml#special-operator-the">the</a> <span class="syntax-interned-symbol">building</span> <a class="macro-reference" href="../chapter-5.xhtml#macro-and">and</a> <span class="syntax-interned-symbol">interpretation</span> <span class="syntax-interned-symbol">of</span> <span class="syntax-interned-symbol">tokens</span>)</span>
</span></code> and parsing <code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">errors</span> <span class="syntax-interned-symbol">in</span> <span class="syntax-interned-symbol">reader</span> <span class="syntax-interned-symbol">macro</span> <span class="syntax-interned-symbol">syntax</span>)</span>
</span></code> by the Lisp reader. <br/>Since <a class="type-reference" href="../chapter-9.xhtml#type-parse-error">parse-error</a> is a subtype of <a class="type-reference" href="../chapter-21.xhtml#type-stream-error">stream-error</a>, objects of this type inherit a <a class="type-reference" href="../chapter-21.xhtml#type-stream">stream</a> slot, which can be accessed using the function <a class="function-reference" href="../chapter-21.xhtml#function-stream-error-stream">stream-error-stream</a>. <br/>Change the discussion in chapter 3 to specify that the type of errors signalled by the reader is <a class="type-reference" href="../chapter-9.xhtml#type-parse-error">parse-error</a>.  There are numerous places that would be affected. <br/></section><section id="section-Rationale" class="section"><h2 class="section-title">Rationale</h2>The general policy that has been followed in other areas of the language where errors must, should, or might be signalled is to specify a particular subtype of <a class="function-reference" href="../chapter-9.xhtml#function-error">error</a> which covers that class of errors.  Doing the same for reader errors would be consistent with the overall policy, but none of the existing error types seem appropriate for reader-related errors. <br/></section><section id="section-Current Practice" class="section"><h2 class="section-title">Current Practice</h2>LispWorks (from Harlequin) reportedly already uses such a condition. <br/></section><section id="section-Cost to implementors" class="section"><h2 class="section-title">Cost to implementors</h2>Trivial. <br/></section><section id="section-Cost to users" class="section"><h2 class="section-title">Cost to users</h2>Probably no user programs rely on the reader signalling any particular type of error yet. <br/></section><section id="section-Benefits" class="section"><h2 class="section-title">Benefits</h2>Increased consistency in the language design. Ability to set up handlers specifically for reader errors. <br/></section><section id="section-Discussion" class="section"><h2 class="section-title">Discussion</h2>Pitman says:   Our later comments will show that i would like this condition to be   called <a class="type-reference" href="../chapter-9.xhtml#type-parse-error">parse-error</a> so that it doesn't seem to be useful only for    READ-related problems but can in fact be used for other parser-style   applications (e.g., a FORTRAN parser, a user-written English-language   interface, etc.). <br/>The initial version of this proposal specified that <a class="type-reference" href="../chapter-9.xhtml#type-parse-error">parse-error</a> was disjoint from <code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">rather</span> <span class="syntax-interned-symbol">than</span> <span class="syntax-interned-symbol">a</span> <span class="syntax-interned-symbol">subtype</span> <span class="syntax-interned-symbol">of</span>)</span>
</span></code> <a class="type-reference" href="../chapter-21.xhtml#type-stream-error">stream-error</a>.  This was changed because there was a suggestion that some conditions should be both a <a class="type-reference" href="../chapter-9.xhtml#type-parse-error">parse-error</a> and a <a class="type-reference" href="../chapter-21.xhtml#type-stream-error">stream-error</a>.  Making it a subtype also allows it to inherit the <a class="type-reference" href="../chapter-21.xhtml#type-stream">stream</a> slot and the <a class="function-reference" href="../chapter-21.xhtml#function-stream-error-stream">stream-error-stream</a> accessor. <br/>Prior to version 3 the condition <a class="type-reference" href="../chapter-9.xhtml#type-parse-error">parse-error</a> was named <a class="type-reference" href="../chapter-23.xhtml#type-reader-error">reader-error</a>. <br/></section></div></main><footer>Copyright © 2021 Jan Moringen</footer></body></html>