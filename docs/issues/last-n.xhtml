<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
  "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><link rel="stylesheet" type="text/css" href="../style.css"/><script src="../permalink.js"/><script src="../navigation.js"/><title>Well-specified Common Lisp — LAST-N</title></head><body><main><nav class="sidebar"><span class="name">Entry Points</span><br/><ol><li><a href="../chap-0.xhtml#section-Figures">Table of Contents</a></li><li><a href="../symbol-index.xhtml#section-SymbolIndex">Symbol Index</a></li><li><a href="../figure-index.xhtml#section-FigureIndex">Figure Index</a></li><li><a href="../issue-index.xhtml#section-IssueIndices">Issue Index</a></li><li><a href="../note-indices.xhtml#section-ReviewerNoteIndex">Note Indices</a></li><li><a href="../chapter-26.xhtml#section-Glossary">Glossary</a></li></ol><hr/><span class="name">LAST-N</span><br/><ol class="local-toc"><li><a href="#section-References">References</a><ol> </ol></li><li><a href="#section-Edit history">Edit history</a><ol> </ol></li><li><a href="#section-Problem Description">Problem Description</a><ol> </ol></li><li><a href="#issue-last-n:allow-optional-argument">Proposal ALLOW-OPTIONAL-ARGUMENT</a><ol> </ol></li><li><a href="#section-Test Cases">Test Cases</a><ol> </ol></li><li><a href="#section-Rationale">Rationale</a><ol> </ol></li><li><a href="#section-Current Practice">Current Practice</a><ol> </ol></li><li><a href="#section-Adoption Cost">Adoption Cost</a><ol> </ol></li><li><a href="#section-Benefits">Benefits</a><ol> </ol></li><li><a href="#section-Conversion Cost">Conversion Cost</a><ol> </ol></li><li><a href="#section-Aesthetics">Aesthetics</a><ol> </ol></li><li><a href="#section-Discussion">Discussion</a><ol> </ol></li></ol></nav><div class="content"><h1>X3J13 Issue LAST-N [NIL] [ENHANCEMENT]</h1><section id="section-References" class="section"><h2 class="section-title">References</h2><a class="function-reference" href="../chapter-14.xhtml#function-last">last</a> (p267) </section><section id="section-Edit history" class="section"><h2 class="section-title">Edit history</h2>04-Dec-87, Version 1 by Pitman 12-Mar-88, Version 2 by Pitman </section><section id="section-Problem Description" class="section"><h2 class="section-title">Problem Description</h2>  People always ask why <a class="function-reference" href="../chapter-14.xhtml#function-last">last</a> returns a cons and not an element. <br/>  <a class="function-reference" href="../chapter-14.xhtml#function-butlast">butlast</a> takes an argument N but <a class="function-reference" href="../chapter-14.xhtml#function-last">last</a> does not. <br/></section><section class="status-unknown proposal" id="issue-last-n:allow-optional-argument"><h2 class="section-title">Proposal ALLOW-OPTIONAL-ARGUMENT</h2>  Allow <a class="function-reference" href="../chapter-14.xhtml#function-last">last</a> to take an optional argument N, saying how many cells to return.   The default for N would be 1. <br/>  It is an error if N is negative or L is circular. <br/>  If N is zero, then the atom that terminates the list L is returned. <br/>  If N is greater than or equal to the number of cons cells in the list   L, then the result is L. <br/></section><section id="section-Test Cases" class="section"><h2 class="section-title">Test Cases</h2><pre> <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-last">last</a>    <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span>)</span></span> <span class="syntax-number">0</span>)</span>
</span></code> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; <code><span class="syntax-root"><span class="syntax-symbol">()</span>
</span></code><br/> <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-butlast">butlast</a> <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span>)</span></span> <span class="syntax-number">0</span>)</span>
</span></code> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; <code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span>)</span>
</span></code><br/><br/> <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-last">last</a>    <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span>)</span></span> <span class="syntax-number">1</span>)</span>
</span></code> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; <code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">C</span>)</span>
</span></code><br/> <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-butlast">butlast</a> <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span>)</span></span> <span class="syntax-number">1</span>)</span>
</span></code> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; <code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span>)</span>
</span></code><br/><br/> <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-last">last</a>    <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span>)</span></span> <span class="syntax-number">2</span>)</span>
</span></code> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; <code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span>)</span>
</span></code><br/> <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-butlast">butlast</a> <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span>)</span></span> <span class="syntax-number">2</span>)</span>
</span></code> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; <code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">A</span>)</span>
</span></code><br/><br/> <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-last">last</a>    <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span>)</span></span> <span class="syntax-number">3</span>)</span>
</span></code> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; <code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span>)</span>
</span></code><br/> <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-butlast">butlast</a> <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span>)</span></span> <span class="syntax-number">3</span>)</span>
</span></code> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; <code><span class="syntax-root"><span class="syntax-symbol">()</span>
</span></code><br/><br/> <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-last">last</a>    <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span>)</span></span> <span class="syntax-number">4</span>)</span>
</span></code> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; <code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span>)</span>
</span></code><br/> <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-butlast">butlast</a> <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span>)</span></span> <span class="syntax-number">4</span>)</span>
</span></code> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; <code><span class="syntax-root"><span class="syntax-symbol">()</span>
</span></code><br/><br/> <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-last">last</a>    <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span>)</span></span>)</span>
</span></code>   <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; <code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">C</span>)</span>
</span></code><br/> <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-butlast">butlast</a> <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span>)</span></span>)</span>
</span></code>   <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; <code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span>)</span>
</span></code><br/><br/> <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-last">last</a> <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-symbol">.</span> <span class="syntax-interned-symbol">B</span>)</span></span> <span class="syntax-number">0</span>)</span>
</span></code>    <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; B<br/> <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-last">last</a> <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-symbol">.</span> <span class="syntax-interned-symbol">B</span>)</span></span> <span class="syntax-number">1</span>)</span>
</span></code>    <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; <code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-symbol">.</span> <span class="syntax-interned-symbol">B</span>)</span>
</span></code><br/> <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-last">last</a> <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-symbol">.</span> <span class="syntax-interned-symbol">B</span>)</span></span> <span class="syntax-number">2</span>)</span>
</span></code>    <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; <code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-symbol">.</span> <span class="syntax-interned-symbol">B</span>)</span>
</span></code><br/><br/></pre></section><section id="section-Rationale" class="section"><h2 class="section-title">Rationale</h2>  <a class="function-reference" href="../chapter-14.xhtml#function-butlast">butlast</a> and <a class="function-reference" href="../chapter-14.xhtml#function-last">last</a> would select complementary parts of a list in general.   That is <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-5.xhtml#function-equal">equal</a> <span class="syntax-interned-symbol">L</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-append">append</a> <span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-butlast">butlast</a> <span class="syntax-interned-symbol">L</span> <span class="syntax-interned-symbol">N</span>)</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-last">last</a> <span class="syntax-interned-symbol">L</span> <span class="syntax-interned-symbol">N</span>)</span>)</span>)</span>
</span></code> would be <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a> for N &gt;<a class="function-reference" href="../chapter-12.xhtml#function-=">=</a> 0   and L being a proper list. <br/>  This would make it more obvious why <a class="function-reference" href="../chapter-14.xhtml#function-last">last</a> should return a list and not   an element. ie, it would return the "last N elements" where N=1 by default. <br/></section><section id="section-Current Practice" class="section"><h2 class="section-title">Current Practice</h2>  Probably nobody does this. <br/></section><section id="section-Adoption Cost" class="section"><h2 class="section-title">Adoption Cost</h2>  Very slight. The following code would suffice: <br/>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="macro-reference" href="../chapter-5.xhtml#macro-defun">defun</a> <a class="function-reference" href="../chapter-14.xhtml#function-last">last</a> <span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-list">list</a> <a class="lambda-list-keyword-reference" href="../chapter-3.xhtml#lambda-list-keyword-optional">&amp;OPTIONAL</a> <span class="syntax-cons">(<span class="syntax-interned-symbol">N</span> <span class="syntax-number">1</span>)</span>)</span>
    <span class="syntax-cons">(<a class="macro-reference" href="../chapter-9.xhtml#macro-check-type">check-type</a> <span class="syntax-interned-symbol">N</span> <span class="syntax-cons">(<a class="type-reference" href="../chapter-12.xhtml#type-integer">integer</a> <span class="syntax-number">0</span>)</span>)</span>
    <span class="syntax-cons">(<a class="macro-reference" href="../chapter-6.xhtml#macro-do">do</a> <span class="syntax-cons">(<span class="syntax-cons">(<span class="syntax-interned-symbol">L</span> <a class="function-reference" href="../chapter-14.xhtml#function-list">list</a> <span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-cdr">cdr</a> <span class="syntax-interned-symbol">L</span>)</span>)</span>
	 <span class="syntax-cons">(<span class="syntax-interned-symbol">R</span> <a class="function-reference" href="../chapter-14.xhtml#function-list">list</a>)</span>
	 <span class="syntax-cons">(<span class="syntax-interned-symbol">I</span> <span class="syntax-number">0</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-12.xhtml#function-+">+</a> <span class="syntax-interned-symbol">I</span> <span class="syntax-number">1</span>)</span>)</span>)</span>
	<span class="syntax-cons">(<span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-atom">atom</a> <span class="syntax-interned-symbol">L</span>)</span> <span class="syntax-interned-symbol">R</span>)</span>
      <span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-if">if</a> <span class="syntax-cons">(<a class="function-reference" href="../chapter-12.xhtml#function-&gt;=">&gt;=</a> <span class="syntax-interned-symbol">I</span> <span class="syntax-interned-symbol">N</span>)</span> <span class="syntax-cons">(<a class="macro-reference" href="../chapter-14.xhtml#macro-pop">pop</a> <span class="syntax-interned-symbol">R</span>)</span>)</span>)</span>)</span>
</span></code></pre> <br/>  Some implementations might want to provide compiler optimizations for   the N=1 case. <br/></section><section id="section-Benefits" class="section"><h2 class="section-title">Benefits</h2>  This utility is probably needed often enough to warrant its inclusion.   It's present <code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">as</span> <span class="syntax-interned-symbol">a</span> <span class="syntax-interned-symbol">separate</span> <a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-function">function</a> <span class="syntax-interned-symbol">called</span> <span class="syntax-interned-symbol">NLEFT</span>)</span>
</span></code> in Symbolics Common   Lisp and Interlisp. <br/></section><section id="section-Conversion Cost" class="section"><h2 class="section-title">Conversion Cost</h2>  None. This is an upward compatible extension. <br/></section><section id="section-Aesthetics" class="section"><h2 class="section-title">Aesthetics</h2>  This would make things a little prettier. <br/></section><section id="section-Discussion" class="section"><h2 class="section-title">Discussion</h2>  This suggestion came up recently on a Symbolics design discussion list.   Symbolics is contemplating offering it as an extension, but it seemed like   the rest of the <a class="package-reference" href="../chapter-11.xhtml#package-cl">cl</a> community might want to adopt it, too.  Pitman thinks   it's a nice idea. <br/>  Masinter opposes this extension as gratuitous. <br/>  Moon and Daniels think this is very low priority but have expressed a   lack of major objection to this proposal. <br/></section></div></main><footer>Copyright © 2021 Jan Moringen</footer></body></html>