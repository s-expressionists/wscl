<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
  "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><link rel="stylesheet" type="text/css" href="../style.css"/><script src="../permalink.js"/><script src="../navigation.js"/><title>Well-specified Common Lisp â€” LOOP-AND-DISCREPANCY</title></head><body><main><nav class="sidebar"><span class="name">Entry Points</span><br/><ol><li><a href="../chap-0.xhtml#section-Figures">Table of Contents</a></li><li><a href="../symbol-index.xhtml#section-SymbolIndex">Symbol Index</a></li><li><a href="../figure-index.xhtml#section-FigureIndex">Figure Index</a></li><li><a href="../issue-index.xhtml#section-IssueIndices">Issue Index</a></li><li><a href="../note-indices.xhtml#section-ReviewerNoteIndex">Note Indices</a></li><li><a href="../chapter-26.xhtml#section-Glossary">Glossary</a></li></ol><hr/><span class="name">LOOP-AND-DISCREPANCY</span><br/><ol class="local-toc"><li><a href="#section-Status">Status</a><ol> </ol></li><li><a href="#section-References">References</a><ol> </ol></li><li><a href="#section-Edit history">Edit history</a><ol> </ol></li><li><a href="#section-Problem description">Problem description</a><ol> </ol></li><li><a href="#issue-loop-and-discrepancy:no-reiteration">Proposal NO-REITERATION</a><ol> </ol></li><li><a href="#section-Examples">Examples</a><ol> </ol></li><li><a href="#section-Rationale">Rationale</a><ol> </ol></li><li><a href="#section-Current practice">Current practice</a><ol> </ol></li><li><a href="#section-Cost to Implementors">Cost to Implementors</a><ol> </ol></li><li><a href="#section-Cost to Users">Cost to Users</a><ol> </ol></li><li><a href="#section-Cost of non-adoption">Cost of non-adoption</a><ol> </ol></li><li><a href="#section-Performance impact">Performance impact</a><ol> </ol></li><li><a href="#section-Benefits">Benefits</a><ol> </ol></li><li><a href="#section-Esthetics">Esthetics</a><ol> </ol></li><li><a href="#section-Discussion">Discussion</a><ol> </ol></li></ol></nav><div class="content"><h1>X3J13 Issue LOOP-AND-DISCREPANCY [NIL] [CHANGE CLARIFICATION]</h1><section id="section-Status" class="status-passed section"><h2 class="section-title">Status</h2>Passed, Mar 89 X3J13 </section><section id="section-References" class="section"><h2 class="section-title">References</h2>Loop Facility document X3J13/89-004 </section><section id="section-Edit history" class="section"><h2 class="section-title">Edit history</h2>Version 1, 15-Mar-88 by Steele </section><section id="section-Problem description" class="section"><h2 class="section-title">Problem description</h2>The treatment of the <a class="macro-reference" href="../chapter-5.xhtml#macro-and">and</a> conjunction in FOR/AS and WITH clauses is not consistent.  Examples of the use of WITH are also not consistent in this respect. <br/>Page 2-5 implies by example that when <a class="macro-reference" href="../chapter-5.xhtml#macro-and">and</a> is used to join two FOR/AS clauses, the word FOR or AS must occur after the word <a class="macro-reference" href="../chapter-5.xhtml#macro-and">and</a>. <br/>Page 2-31 has formal syntax specifying that when <a class="macro-reference" href="../chapter-5.xhtml#macro-and">and</a> is used to join two WITH clauses, the word WITH must *not* occur after the word <a class="macro-reference" href="../chapter-5.xhtml#macro-and">and</a>.  Examples on that page are consistent with this specification. <br/>Page 2-41 has an example in which WITH is repeated after <a class="macro-reference" href="../chapter-5.xhtml#macro-and">and</a>. <br/></section><section class="status-passed proposal" id="issue-loop-and-discrepancy:no-reiteration"><h2 class="section-title">Proposal NO-REITERATION</h2>Let stand the formal syntax for WITH. <br/>Change the description of FOR/AS clauses to specify that when two or more such clauses are joined with <a class="macro-reference" href="../chapter-5.xhtml#macro-and">and</a>, clauses after the first do not have FOR or AS before them. <br/>The complete formal syntax for FOR/AS may be described as follows: <br/>for-as ::<a class="function-reference" href="../chapter-12.xhtml#function-=">=</a> {FOR | AS} for-as-subclause {<a class="macro-reference" href="../chapter-5.xhtml#macro-and">and</a> for-as-subclause}* <br/>for-as-subclause ::<a class="function-reference" href="../chapter-12.xhtml#function-=">=</a> for-as-arithmetic | for-as-in-list 		   | for-as-on-list | for-as-equals-then 		   | for-as-across | for-as-hash | for-as-package <br/>for-as-arithmetic ::<a class="function-reference" href="../chapter-12.xhtml#function-=">=</a> var [type-spec] ... <br/>and so on. <br/></section><section id="section-Examples" class="section"><h2 class="section-title">Examples</h2><pre>&gt; <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="macro-reference" href="../chapter-6.xhtml#macro-loop">loop</a> <span class="syntax-interned-symbol">for</span> <span class="syntax-interned-symbol">x</span> <span class="syntax-interned-symbol">from</span> <span class="syntax-number">1</span> <span class="syntax-interned-symbol">to</span> <span class="syntax-number">10</span>		<span class="syntax-line-comment syntax-comment">;Corrected from X3J13/89-004, page 2-5
</span>        <a class="macro-reference" href="../chapter-5.xhtml#macro-and">and</a> <span class="syntax-interned-symbol">y</span> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a> <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a> <span class="syntax-interned-symbol">then</span> <span class="syntax-interned-symbol">x</span>
        <span class="syntax-interned-symbol">collect</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-list">list</a> <span class="syntax-interned-symbol">x</span> <span class="syntax-interned-symbol">y</span>)</span>)</span>
</span></code></pre><br/><pre><code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-cons">(<span class="syntax-number">1</span> <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a>)</span> <span class="syntax-cons">(<span class="syntax-number">2</span> <span class="syntax-number">1</span>)</span> <span class="syntax-cons">(<span class="syntax-number">3</span> <span class="syntax-number">2</span>)</span> <span class="syntax-cons">(<span class="syntax-number">4</span> <span class="syntax-number">3</span>)</span> <span class="syntax-cons">(<span class="syntax-number">5</span> <span class="syntax-number">4</span>)</span> <span class="syntax-cons">(<span class="syntax-number">6</span> <span class="syntax-number">5</span>)</span> <span class="syntax-cons">(<span class="syntax-number">7</span> <span class="syntax-number">6</span>)</span> <span class="syntax-cons">(<span class="syntax-number">8</span> <span class="syntax-number">7</span>)</span> <span class="syntax-cons">(<span class="syntax-number">9</span> <span class="syntax-number">8</span>)</span> <span class="syntax-cons">(<span class="syntax-number">10</span> <span class="syntax-number">9</span>)</span>)</span>
</span></code></pre><br/><br/>&gt; <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="macro-reference" href="../chapter-6.xhtml#macro-loop">loop</a> <span class="syntax-interned-symbol">with</span> <span class="syntax-cons">(<span class="syntax-interned-symbol">a</span> <span class="syntax-interned-symbol">b</span>)</span> <a class="function-reference" href="../chapter-12.xhtml#function-float">float</a> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a> <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-number">1.0</span> <span class="syntax-number">2.0</span>)</span></span>	<span class="syntax-line-comment syntax-comment">;Corrected from X3J13/89-004, page 2-41
</span>        <a class="macro-reference" href="../chapter-5.xhtml#macro-and">and</a> <span class="syntax-cons">(<span class="syntax-interned-symbol">c</span> <span class="syntax-interned-symbol">d</span>)</span> <a class="type-reference" href="../chapter-12.xhtml#type-integer">integer</a> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a> <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-number">3</span> <span class="syntax-number">4</span>)</span></span>
        <a class="macro-reference" href="../chapter-5.xhtml#macro-and">and</a> <span class="syntax-cons">(<span class="syntax-interned-symbol">e</span> <span class="syntax-interned-symbol">f</span>)</span>
        <a class="macro-reference" href="../chapter-5.xhtml#macro-return">return</a> <span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-list">list</a> <span class="syntax-interned-symbol">a</span> <span class="syntax-interned-symbol">b</span> <span class="syntax-interned-symbol">c</span> <span class="syntax-interned-symbol">d</span> <span class="syntax-interned-symbol">e</span> <span class="syntax-interned-symbol">f</span>)</span>)</span>
</span></code></pre><br/><pre><code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-number">1.0</span> <span class="syntax-number">2.0</span> <span class="syntax-number">3</span> <span class="syntax-number">4</span> <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a> <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a>)</span>
</span></code></pre><br/><br/></pre></section><section id="section-Rationale" class="section"><h2 class="section-title">Rationale</h2>The treatment of <a class="macro-reference" href="../chapter-5.xhtml#macro-and">and</a> should be internally consistent.  There is no reason to repeat the FOR/AS keyword.  Not repeating the keyword emphasizes that the subclauses are functionally linked under the heading of WITH or FOR. (Compare to the third use of <a class="macro-reference" href="../chapter-5.xhtml#macro-and">and</a> in <a class="macro-reference" href="../chapter-6.xhtml#macro-loop">loop</a>, to link clauses controlled by WHEN/IF/UNLESS.  One does not repeat the <a class="macro-reference" href="../chapter-5.xhtml#macro-when">when</a>; rather, the clauses grouped by <a class="macro-reference" href="../chapter-5.xhtml#macro-and">and</a> are controlled by a single <a class="macro-reference" href="../chapter-5.xhtml#macro-when">when</a>.) <br/></section><section id="section-Current practice" class="section"><h2 class="section-title">Current practice</h2>Symbolics <a class="macro-reference" href="../chapter-6.xhtml#macro-loop">loop</a> allows FOR to be included or omitted after <a class="macro-reference" href="../chapter-5.xhtml#macro-and">and</a>, with identical meanings.  WITH may not be repeated after <a class="macro-reference" href="../chapter-5.xhtml#macro-and">and</a>. <br/></section><section id="section-Cost to Implementors" class="section"><h2 class="section-title">Cost to Implementors</h2>Small? </section><section id="section-Cost to Users" class="section"><h2 class="section-title">Cost to Users</h2>Possible incompatibility with existing implementors' extensions. </section><section id="section-Cost of non-adoption" class="section"><h2 class="section-title">Cost of non-adoption</h2>Utter confusion. </section><section id="section-Performance impact" class="section"><h2 class="section-title">Performance impact</h2>None. </section><section id="section-Benefits" class="section"><h2 class="section-title">Benefits</h2>Consistent treatment of <a class="macro-reference" href="../chapter-5.xhtml#macro-and">and</a> within <a class="macro-reference" href="../chapter-6.xhtml#macro-loop">loop</a>. </section><section id="section-Esthetics" class="section"><h2 class="section-title">Esthetics</h2>Absolutely none.  We're talking about <a class="macro-reference" href="../chapter-6.xhtml#macro-loop">loop</a> here. <br/></section><section id="section-Discussion" class="section"><h2 class="section-title">Discussion</h2>Steele supports this proposal.  It is a reversal of his previous suggestion on the topic, thanks to feedback from Moon. </section></div></main><footer>Copyright Â© 2021 Jan Moringen</footer></body></html>