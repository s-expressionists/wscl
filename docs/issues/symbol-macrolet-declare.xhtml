<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
  "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><link rel="stylesheet" type="text/css" href="../style.css"/><script src="../permalink.js"/><script src="../navigation.js"/><title>Well-specified Common Lisp — SYMBOL-MACROLET-DECLARE</title></head><body><main><nav class="sidebar"><span class="name">Entry Points</span><br/><ol><li><a href="../chap-0.xhtml#section-Figures">Table of Contents</a></li><li><a href="../symbol-index.xhtml#section-SymbolIndex">Symbol Index</a></li><li><a href="../figure-index.xhtml#section-FigureIndex">Figure Index</a></li><li><a href="../issue-index.xhtml#section-IssueIndices">Issue Index</a></li><li><a href="../note-indices.xhtml#section-ReviewerNoteIndex">Note Indices</a></li><li><a href="../chapter-26.xhtml#section-Glossary">Glossary</a></li></ol><hr/><span class="name">SYMBOL-MACROLET-DECLARE</span><br/><ol class="local-toc"><li><a href="#section-Status">Status</a><ol> </ol></li><li><a href="#section-References">References</a><ol> </ol></li><li><a href="#section-Edit history">Edit history</a><ol> </ol></li><li><a href="#section-Problem description">Problem description</a><ol> </ol></li><li><a href="#issue-symbol-macrolet-declare:allow">Proposal ALLOW</a><ol> </ol></li><li><a href="#section-Example">Example</a><ol> </ol></li><li><a href="#section-Rationale">Rationale</a><ol> </ol></li><li><a href="#section-Current practice">Current practice</a><ol> </ol></li><li><a href="#section-Cost to Implementors">Cost to Implementors</a><ol> </ol></li><li><a href="#section-Cost to Users">Cost to Users</a><ol> </ol></li><li><a href="#section-Cost of non-adoption">Cost of non-adoption</a><ol> </ol></li><li><a href="#section-Benefits">Benefits</a><ol> </ol></li><li><a href="#section-Esthetics">Esthetics</a><ol> </ol></li><li><a href="#section-Discussion">Discussion</a><ol> </ol></li></ol></nav><div class="content"><h1>X3J13 Issue SYMBOL-MACROLET-DECLARE [NIL] [ADDITION]</h1><h2>Related issues</h2><ul><a class="issue-reference" href="../issues/symbol-macrolet-semantics.xhtml#issue-symbol-macrolet-semantics">SYMBOL-MACROLET-SEMANTICS</a><a class="issue-reference" href="../issues/flet-declarations.xhtml#issue-flet-declarations">FLET-DECLARATIONS</a></ul><section id="section-Status" class="status-passed section"><h2 class="section-title">Status</h2>Passed, Jan 89 X3J13 </section><section id="section-References" class="section"><h2 class="section-title">References</h2><a class="special-operator-reference" href="../chapter-3.xhtml#special-operator-symbol-macrolet">symbol-macrolet</a> (88-002R page 2-81) <a class="macro-reference" href="../chapter-7.xhtml#macro-with-accessors">with-accessors</a> (88-002R page 2-88) <a class="macro-reference" href="../chapter-7.xhtml#macro-with-slots">with-slots</a> (88-002R page 2-92) </section><section id="section-Edit history" class="section"><h2 class="section-title">Edit history</h2>Version 1, 12-Sep-88, Moon Version 2,  9-Dec-88, Masinter (add cross reference, discussion) </section><section id="section-Problem description" class="section"><h2 class="section-title">Problem description</h2>It would be both natural and nice to be able to write <br/>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="macro-reference" href="../chapter-7.xhtml#macro-with-slots">with-slots</a> <span class="syntax-cons">(<span class="syntax-interned-symbol">rho</span> <span class="syntax-interned-symbol">theta</span>)</span> <span class="syntax-interned-symbol">point</span>
    <span class="syntax-cons">(<a class="symbol-reference" href="../chapter-3.xhtml#symbol-declare">declare</a> <span class="syntax-cons">(<a class="type-reference" href="../chapter-12.xhtml#type-single-float">single-float</a> <span class="syntax-interned-symbol">rho</span> <span class="syntax-interned-symbol">theta</span>)</span>)</span>
    <span class="syntax-interned-symbol">...computation...</span>)</span>
</span></code></pre> <br/></section><section class="status-passed proposal" id="issue-symbol-macrolet-declare:allow"><h2 class="section-title">Proposal ALLOW</h2>Allow declarations at the head of the body of <a class="special-operator-reference" href="../chapter-3.xhtml#special-operator-symbol-macrolet">symbol-macrolet</a>, and hence in <a class="macro-reference" href="../chapter-7.xhtml#macro-with-accessors">with-accessors</a> and <a class="macro-reference" href="../chapter-7.xhtml#macro-with-slots">with-slots</a>.  Exactly the same declarations are allowed as for <a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-let">let</a>, with one exception: <a class="special-operator-reference" href="../chapter-3.xhtml#special-operator-symbol-macrolet">symbol-macrolet</a> signals an error if a <a class="symbol-reference" href="../chapter-3.xhtml#symbol-special">special</a> declaration names one of the symbols being defined as a <a class="special-operator-reference" href="../chapter-3.xhtml#special-operator-symbol-macrolet">symbol-macrolet</a>.  A type declaration of one of these symbols is equivalent to wrapping a <a class="special-operator-reference" href="../chapter-3.xhtml#special-operator-the">the</a> expression around the expansion of that symbol. <br/></section><section id="section-Example" class="section"><h2 class="section-title">Example</h2><pre>See problem description.<br/><br/></pre></section><section id="section-Rationale" class="section"><h2 class="section-title">Rationale</h2>If <a class="special-operator-reference" href="../chapter-3.xhtml#special-operator-symbol-macrolet">symbol-macrolet</a> is intended to resemble <a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-let">let</a> in syntax, it ought to allow declarations.  When writing a <a class="special-operator-reference" href="../chapter-3.xhtml#special-operator-symbol-macrolet">symbol-macrolet</a> directly, the user could just as easily write a <a class="special-operator-reference" href="../chapter-3.xhtml#special-operator-the">the</a> expression instead of a type declaration.  However, when invoking a macro such as <a class="macro-reference" href="../chapter-7.xhtml#macro-with-slots">with-slots</a> that expands into <a class="special-operator-reference" href="../chapter-3.xhtml#special-operator-symbol-macrolet">symbol-macrolet</a>, the user does not have this option since the expansion is not supplied explicitly by the user. <br/></section><section id="section-Current practice" class="section"><h2 class="section-title">Current practice</h2><a class="special-operator-reference" href="../chapter-3.xhtml#special-operator-symbol-macrolet">symbol-macrolet</a> was only tentatively added to Common Lisp 3 months ago. <br/></section><section id="section-Cost to Implementors" class="section"><h2 class="section-title">Cost to Implementors</h2>Less than one man-hour. <br/></section><section id="section-Cost to Users" class="section"><h2 class="section-title">Cost to Users</h2>None. <br/></section><section id="section-Cost of non-adoption" class="section"><h2 class="section-title">Cost of non-adoption</h2>Minor wart in the language. <br/></section><section id="section-Benefits" class="section"><h2 class="section-title">Benefits</h2>More consistent language definition. <br/></section><section id="section-Esthetics" class="section"><h2 class="section-title">Esthetics</h2>More consistent language definition. <br/></section><section id="section-Discussion" class="section"><h2 class="section-title">Discussion</h2>This issue is related to <a class="issue-reference" href="../issues/symbol-macrolet-semantics.xhtml#issue-symbol-macrolet-semantics">symbol-macrolet-semantics</a>. <br/>"A macro-definition for <a class="special-operator-reference" href="../chapter-3.xhtml#special-operator-symbol-macrolet">symbol-macrolet</a> would leave the issue of <a class="symbol-reference" href="../chapter-3.xhtml#symbol-declare">declare</a> open.  But the special-form version of <a class="special-operator-reference" href="../chapter-3.xhtml#special-operator-symbol-macrolet">symbol-macrolet</a> really should address it." </section></div></main><footer>Copyright © 2021 Jan Moringen</footer></body></html>