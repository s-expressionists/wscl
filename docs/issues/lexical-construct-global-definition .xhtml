<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
  "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><link rel="stylesheet" type="text/css" href="../style.css"/><script src="../permalink.js"/><script src="../navigation.js"/><title>Well-specified Common Lisp — LEXICAL-CONSTRUCT-GLOBAL-DEFINITION </title></head><body><main><nav class="sidebar"><span class="name">Entry Points</span><br/><ol><li><a href="../chap-0.xhtml#section-Figures">Table of Contents</a></li><li><a href="../symbol-index.xhtml#section-SymbolIndex">Symbol Index</a></li><li><a href="../figure-index.xhtml#section-FigureIndex">Figure Index</a></li><li><a href="../issue-index.xhtml#section-IssueIndices">Issue Index</a></li><li><a href="../note-indices.xhtml#section-ReviewerNoteIndex">Note Indices</a></li><li><a href="../chapter-26.xhtml#section-Glossary">Glossary</a></li></ol><hr/><span class="name">LEXICAL-CONSTRUCT-GLOBAL-DEFINITION </span><br/><ol class="local-toc"><li><a href="#section-References">References</a><ol> </ol></li><li><a href="#section-Edit history">Edit history</a><ol> </ol></li><li><a href="#section-Problem description">Problem description</a><ol> </ol></li><li><a href="#issue-lexical-construct-global-definition:undefined">Proposal UNDEFINED</a><ol> </ol></li><li><a href="#section-Rationale">Rationale</a><ol> </ol></li><li><a href="#section-Current Practice">Current Practice</a><ol> </ol></li><li><a href="#section-Cost to Implementors">Cost to Implementors</a><ol> </ol></li><li><a href="#section-Cost to Users">Cost to Users</a><ol> </ol></li><li><a href="#section-Cost of non-adoption">Cost of non-adoption</a><ol> </ol></li><li><a href="#section-Performance impact">Performance impact</a><ol> </ol></li><li><a href="#section-Benefits">Benefits</a><ol> </ol></li><li><a href="#section-Esthetics">Esthetics</a><ol> </ol></li><li><a href="#section-Discussion">Discussion</a><ol> </ol></li></ol></nav><div class="content"><h1>X3J13 Issue LEXICAL-CONSTRUCT-GLOBAL-DEFINITION  [NIL] [CLARIFICATION, CHANGE]</h1><h2>Related issues</h2><ul><a class="issue-reference" href="../issues/lisp-symbol-redefinition.xhtml#issue-lisp-symbol-redefinition">X3J13 Issue LISP-SYMBOL-REDEFINITION</a><a class="issue-reference" href="../issues/pretty-print-interface.xhtml#issue-pretty-print-interface">X3J13 Issue PRETTY-PRINT-INTERFACE</a><span class="issue-reference error">issue:Issue LOOP-FINISH-NOT-FINISHED</span></ul><section id="section-References" class="section"><h2 class="section-title">References</h2><a class="macro-reference" href="../chapter-22.xhtml#macro-pprint-exit-if-list-exhausted">pprint-exit-if-list-exhausted</a> <a class="macro-reference" href="../chapter-22.xhtml#macro-pprint-pop">pprint-pop</a> <a class="macro-reference" href="../chapter-6.xhtml#macro-loop-finish">loop-finish</a> <a class="macro-reference" href="../chapter-7.xhtml#macro-call-method">call-method</a> <a class="function-reference" href="../chapter-7.xhtml#function-call-next-method">call-next-method</a> <a class="function-reference" href="../chapter-7.xhtml#function-next-method-p">next-method-p</a> </section><section id="section-Edit history" class="section"><h2 class="section-title">Edit history</h2>V1, 05 May 90, Sandra Loosemore V2, 29 May 90, Sandra Loosemore (forgot one) </section><section id="section-Problem description" class="section"><h2 class="section-title">Problem description</h2>The description of <a class="macro-reference" href="../chapter-22.xhtml#macro-pprint-exit-if-list-exhausted">pprint-exit-if-list-exhausted</a> and <a class="macro-reference" href="../chapter-22.xhtml#macro-pprint-pop">pprint-pop</a> in <a class="issue-reference" href="../issues/pretty-print-interface.xhtml#issue-pretty-print-interface">X3J13 Issue PRETTY-PRINT-INTERFACE</a> specifies that "an error message is issued" if either of these constructs are used anywhere other than syntactically nested within a call on <a class="macro-reference" href="../chapter-22.xhtml#macro-pprint-logical-block">pprint-logical-block</a>. It is not clear whether this means "an error is signalled" or "a message is printed", or whether this situation must be detected at compile time or at run time. <br/>This is actually a more general problem, since there are other  constructs in the language that have similar scoping requirements:   notably <a class="macro-reference" href="../chapter-6.xhtml#macro-loop-finish">loop-finish</a>, <a class="macro-reference" href="../chapter-7.xhtml#macro-call-method">call-method</a>, <a class="function-reference" href="../chapter-7.xhtml#function-call-next-method">call-next-method</a>, and <a class="function-reference" href="../chapter-7.xhtml#function-next-method-p">next-method-p</a>.   The error behavior of all of these constructs when they are referenced outside the lexical scope where their behavior is defined ought to be made consistent, as should the matter of whether they are permitted/required/not allowed to be globally <a class="function-reference" href="../chapter-5.xhtml#function-fboundp">fboundp</a>.   <br/>This issue incorporates items #2 and #23 from Loosemore's list. <br/></section><section class="status-unknown proposal" id="issue-lexical-construct-global-definition:undefined"><h2 class="section-title">Proposal UNDEFINED</h2>  This proposal affects the constructs <a class="macro-reference" href="../chapter-22.xhtml#macro-pprint-exit-if-list-exhausted">pprint-exit-if-list-exhausted</a>,    <a class="macro-reference" href="../chapter-22.xhtml#macro-pprint-pop">pprint-pop</a>, <a class="macro-reference" href="../chapter-6.xhtml#macro-loop-finish">loop-finish</a>, <a class="macro-reference" href="../chapter-7.xhtml#macro-call-method">call-method</a>, <a class="function-reference" href="../chapter-7.xhtml#function-call-next-method">call-next-method</a>, and    <a class="function-reference" href="../chapter-7.xhtml#function-next-method-p">next-method-p</a>, which are referred to as "lexically-scoped operators". <br/><ol><li> Change the descriptions of lexically-scoped operators to state that any attempt to invoke the operator outside of the lexical scope where its behavior is defined has undefined consequences. <br/></li><li> Clarify that it is unspecified whether function names that are defined by the standard as lexically-scoped operators have global function or macro definitions (i.e., are <a class="function-reference" href="../chapter-5.xhtml#function-fboundp">fboundp</a>). <br/></li><li> Clarify that the restrictions on redefinition or shadowing of symbols in the <a class="package-reference" href="../chapter-1.xhtml#package-common-lisp">common-lisp</a> package <pre><code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">originally</span> <span class="syntax-interned-symbol">stated</span> <span class="syntax-interned-symbol">in</span> <span class="syntax-interned-symbol">issue</span> 
  <span class="syntax-interned-symbol">LISP-SYMBOL-REDEFINITION</span>)</span>
</span></code></pre> are the same for symbols that define  lexical operators as for symbols that are globally defined as operators. <br/></li></ol></section><section id="section-Rationale" class="section"><h2 class="section-title">Rationale</h2>  This gives maximum freedom to implementors and avoids having to   deal with sticky issues about whether errors are detected at   compile or run time, etc. <br/></section><section id="section-Current Practice" class="section"><h2 class="section-title">Current Practice</h2>  I suspect it is fairly common practice to define these operators   using <a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-macrolet">macrolet</a> <pre><code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">etc</span>)</span>
</span></code></pre> and provide a global definition that   signals an error if it is invoked. <br/></section><section id="section-Cost to Implementors" class="section"><h2 class="section-title">Cost to Implementors</h2>  None. <br/></section><section id="section-Cost to Users" class="section"><h2 class="section-title">Cost to Users</h2>  None. <br/></section><section id="section-Cost of non-adoption" class="section"><h2 class="section-title">Cost of non-adoption</h2>  Part of the language specification remains imprecise,   inconsistent, and confusing. <br/></section><section id="section-Performance impact" class="section"><h2 class="section-title">Performance impact</h2>  None. <br/></section><section id="section-Benefits" class="section"><h2 class="section-title">Benefits</h2>  The language specification is made more precise, consistent,   and less confusing. <br/></section><section id="section-Esthetics" class="section"><h2 class="section-title">Esthetics</h2>  Treating all of these guys uniformly is better than having them   all specify something slightly different with regard to their   behavior. <br/></section><section id="section-Discussion" class="section"><h2 class="section-title">Discussion</h2>The situation with the <a class="symbol-reference" href="../chapter-3.xhtml#symbol-declare">declare</a> special form is related but not entirely analogous, so it has been left out of this proposal. From a purely abstract point of view, <a class="symbol-reference" href="../chapter-3.xhtml#symbol-declare">declare</a> is not a special form  at all but simply a syntactic marker like <a class="macro-reference" href="../chapter-3.xhtml#macro-lambda">lambda</a>, and the only reason for defining it as an operator is to facilitate diagnostics about misplaced declarations. </section></div></main><footer>Copyright © 2021 Jan Moringen</footer></body></html>