<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
  "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><link rel="stylesheet" type="text/css" href="../style.css"/><script src="../permalink.js"/><script src="../navigation.js"/><title>Well-specified Common Lisp — DECLARE-FUNCTION-AMBIGUITY</title></head><body><main><nav class="sidebar"><span class="name">Entry Points</span><br/><ol><li><a href="../chap-0.xhtml#section-Figures">Table of Contents</a></li><li><a href="../symbol-index.xhtml#section-SymbolIndex">Symbol Index</a></li><li><a href="../figure-index.xhtml#section-FigureIndex">Figure Index</a></li><li><a href="../issue-index.xhtml#section-IssueIndices">Issue Index</a></li><li><a href="../note-indices.xhtml#section-ReviewerNoteIndex">Note Indices</a></li><li><a href="../chapter-26.xhtml#section-Glossary">Glossary</a></li></ol><hr/><span class="name">DECLARE-FUNCTION-AMBIGUITY</span><br/><ol class="local-toc"><li><a href="#section-Status">Status</a><ol> </ol></li><li><a href="#section-References">References</a><ol> </ol></li><li><a href="#section-Edit history">Edit history</a><ol> </ol></li><li><a href="#section-Problem description">Problem description</a><ol> </ol></li><li><a href="#issue-declare-function-ambiguity:delete-ftype-abbreviation">Proposal DELETE-FTYPE-ABBREVIATION</a><ol> </ol></li><li><a href="#section-Rationale">Rationale</a><ol> </ol></li><li><a href="#section-Current Practice">Current Practice</a><ol> </ol></li><li><a href="#section-Cost to Implementors">Cost to Implementors</a><ol> </ol></li><li><a href="#section-Cost to Users">Cost to Users</a><ol> </ol></li><li><a href="#section-Cost of Non-Adoption">Cost of Non-Adoption</a><ol> </ol></li><li><a href="#section-Benefits">Benefits</a><ol> </ol></li><li><a href="#section-Esthetics">Esthetics</a><ol> </ol></li><li><a href="#section-Discussion">Discussion</a><ol> </ol></li></ol></nav><div class="content"><h1>X3J13 Issue DECLARE-FUNCTION-AMBIGUITY [Cleanup] [CHANGE]</h1><section id="section-Status" class="status-passed section"><h2 class="section-title">Status</h2>Passed, Jan 89 X3J13 </section><section id="section-References" class="section"><h2 class="section-title">References</h2>CLtL pp 43 (Table 4-1), 158-159 <a class="issue-reference" href="../issues/function-type.xhtml#issue-function-type">X3J13 Issue FUNCTION-TYPE</a> (passed X3J13/June 1988) </section><section id="section-Edit history" class="section"><h2 class="section-title">Edit history</h2>#1, 21 Sept 1988, Walter van Roggen #2, 29 Sept 1988, Walter van Roggen (renamed; lessened ambiguity) #3, 30-Sep-88, Masinter #4,  5-Dec-88, Masinter (append Oct x3j13 comments) </section><section id="section-Problem description" class="section"><h2 class="section-title">Problem description</h2>CLtL permits confusing and ambiguous <a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-function">function</a> declarations.  One can say   <code><span class="syntax-root"><span class="syntax-cons">(<a class="symbol-reference" href="../chapter-3.xhtml#symbol-declare">declare</a> <span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-function">function</a> <span class="syntax-interned-symbol">F</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-15.xhtml#function-vector">vector</a> <a class="type-reference" href="../chapter-12.xhtml#type-integer">integer</a>)</span> <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a>)</span>)</span>
</span></code> to indicate that the function binding for F is of a certain type.  Yet one can also say   <code><span class="syntax-root"><span class="syntax-cons">(<a class="symbol-reference" href="../chapter-3.xhtml#symbol-declare">declare</a> <span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-function">function</a> <span class="syntax-interned-symbol">X</span> <span class="syntax-interned-symbol">Y</span> <span class="syntax-interned-symbol">Z</span>)</span>)</span>
</span></code> to indicate that the variables X, Y, and Z have values which are functions. <br/>The former is an abbreviation for   <code><span class="syntax-root"><span class="syntax-cons">(<a class="symbol-reference" href="../chapter-3.xhtml#symbol-declare">declare</a> <span class="syntax-cons">(<a class="declaration-reference" href="../chapter-3.xhtml#declaration-ftype">ftype</a> <span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-function">function</a> <span class="syntax-cons">(<a class="function-reference" href="../chapter-15.xhtml#function-vector">vector</a> <a class="type-reference" href="../chapter-12.xhtml#type-integer">integer</a>)</span> <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a>)</span> <span class="syntax-interned-symbol">F</span>)</span>)</span>
</span></code> The latter is an abbreviation for   <code><span class="syntax-root"><span class="syntax-cons">(<a class="symbol-reference" href="../chapter-3.xhtml#symbol-declare">declare</a> <span class="syntax-cons">(<a class="symbol-reference" href="../chapter-25.xhtml#symbol-type">type</a> <a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-function">function</a> <span class="syntax-interned-symbol">X</span> <span class="syntax-interned-symbol">Y</span> <span class="syntax-interned-symbol">Z</span>)</span>)</span>
</span></code> <br/>The ambiguity arises in a case like   <code><span class="syntax-root"><span class="syntax-cons">(<a class="symbol-reference" href="../chapter-3.xhtml#symbol-declare">declare</a> <span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-function">function</a> <span class="syntax-interned-symbol">F</span> <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a> <a class="function-reference" href="../chapter-16.xhtml#function-string">string</a>)</span>)</span>
</span></code> However, it would be an error to declare the type of the constant <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a> to be a <a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-function">function</a>, so technically there is no ambiguity--there is just a peculiar special case. <br/>Using the same declaration for two completely different purposes can lead  to confusion among people writing or reading such code. <br/>It is now more useful to declare that variables have a value which is of type <a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-function">function</a>, since the type <a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-function">function</a> has a more well-specified meaning. <br/></section><section class="status-passed proposal" id="issue-declare-function-ambiguity:delete-ftype-abbreviation"><h2 class="section-title">Proposal DELETE-FTYPE-ABBREVIATION</h2>The declaration <code><span class="syntax-root"><span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-function">function</a> <span class="syntax-interned-symbol">name</span> <span class="syntax-interned-symbol">argtypes</span> <span class="syntax-interned-symbol">valtypes</span>)</span>
</span></code> is no longer permitted to be an abbreviation for <code><span class="syntax-root"><span class="syntax-cons">(<a class="declaration-reference" href="../chapter-3.xhtml#declaration-ftype">ftype</a> <span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-function">function</a> <span class="syntax-interned-symbol">argtypes</span> <span class="syntax-interned-symbol">valtypes</span>)</span> <span class="syntax-interned-symbol">name</span>)</span>
</span></code>. <br/>The declaration <code><span class="syntax-root"><span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-function">function</a> <span class="syntax-interned-symbol">var1</span> <span class="syntax-interned-symbol">var2</span>)</span>
</span></code> would just be an abbreviation for <code><span class="syntax-root"><span class="syntax-cons">(<a class="symbol-reference" href="../chapter-25.xhtml#symbol-type">type</a> <a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-function">function</a> <span class="syntax-interned-symbol">var1</span> <span class="syntax-interned-symbol">var2</span>)</span>
</span></code>. <br/></section><section id="section-Rationale" class="section"><h2 class="section-title">Rationale</h2>Continuing to allow all the predefined atomic type specifiers as declaration abbreviations for <code><span class="syntax-root"><span class="syntax-cons">(<a class="symbol-reference" href="../chapter-25.xhtml#symbol-type">type</a> <a class="symbol-reference" href="../chapter-25.xhtml#symbol-type">type</a> <span class="syntax-interned-symbol">var1</span> <span class="syntax-interned-symbol">var2</span> <span class="syntax-interned-symbol">...</span>)</span>
</span></code> is simpler for users to understand. In other words, all the normal type declarations describe variable bindings; only the <a class="declaration-reference" href="../chapter-3.xhtml#declaration-ftype">ftype</a> declaration describes function bindings.  This is a more uniform solution than making an exception to table 4-1. <br/>Since the old use of the <a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-function">function</a> declaration for function bindings was just an abbreviation for the <a class="declaration-reference" href="../chapter-3.xhtml#declaration-ftype">ftype</a> declaration, no expressivity is lost. Furthermore one is able to say that a variable's value is of type <a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-function">function</a>, something that hadn't been clearly possible without using the <a class="symbol-reference" href="../chapter-25.xhtml#symbol-type">type</a> declaration. <br/></section><section id="section-Current Practice" class="section"><h2 class="section-title">Current Practice</h2>Many current implementations treat <a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-function">function</a> declarations  only as abbreviations for <a class="declaration-reference" href="../chapter-3.xhtml#declaration-ftype">ftype</a> declarations, primarily because the proposal <a class="issue-reference" href="../issues/function-type.xhtml#issue-function-type">function-type</a> has not been widely implemented. <br/></section><section id="section-Cost to Implementors" class="section"><h2 class="section-title">Cost to Implementors</h2>Likely to be small to those implementations that heed these kinds of declarations; none for those that don't. <br/></section><section id="section-Cost to Users" class="section"><h2 class="section-title">Cost to Users</h2>Existing uses of the <a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-function">function</a> declaration for function bindings will need to be changed to <a class="declaration-reference" href="../chapter-3.xhtml#declaration-ftype">ftype</a> declarations. <br/></section><section id="section-Cost of Non-Adoption" class="section"><h2 class="section-title">Cost of Non-Adoption</h2>People will continue to be confused by function declarations. <br/></section><section id="section-Benefits" class="section"><h2 class="section-title">Benefits</h2>A simpler language. <br/></section><section id="section-Esthetics" class="section"><h2 class="section-title">Esthetics</h2></section><section id="section-Discussion" class="section"><h2 class="section-title">Discussion</h2>Making it clear that only <a class="declaration-reference" href="../chapter-3.xhtml#declaration-ftype">ftype</a> declarations describe function bindings will make it easier to add new kinds of declarations that support incremental or additional descriptions, as is needed for describing methods. <br/>Since all cases can be disambiguated after all, compatibility considerations might deem this proposal to be unnecessary.  However, making declarations simpler and less confusing is possibly more important than compatibility. <br/>There is no consensus on the cleanup committee. <br/>Comments from October 1988 X3J13 meeting: <br/>...    opposed but not vehemently--the incompatible change is gratuitous ...    prefer to document the 	 issue rather than change it." ...    a number of implementations accidentally implement    	 this incorrectly. They first check the type table and then handle 	 the elaborate function declaration style. But, as it happens, 	 they never reach the code for the second case because function is 	 in the type table! ...    Having both styles is worse than having either one or the other. </section></div></main><footer>Copyright © 2021 Jan Moringen</footer></body></html>