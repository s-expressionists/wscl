<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
  "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><link rel="stylesheet" type="text/css" href="../style.css"/><script src="../permalink.js"/><script src="../navigation.js"/><title>Well-specified Common Lisp — TAILP-NIL</title></head><body><main><nav class="sidebar"><span class="name">Entry Points</span><br/><ol><li><a href="../chap-0.xhtml#section-Figures">Table of Contents</a></li><li><a href="../symbol-index.xhtml#section-SymbolIndex">Symbol Index</a></li><li><a href="../figure-index.xhtml#section-FigureIndex">Figure Index</a></li><li><a href="../issue-index.xhtml#section-IssueIndices">Issue Index</a></li><li><a href="../note-indices.xhtml#section-ReviewerNoteIndex">Note Indices</a></li><li><a href="../chapter-26.xhtml#section-Glossary">Glossary</a></li></ol><hr/><span class="name">TAILP-NIL</span><br/><ol class="local-toc"><li><a href="#section-Status">Status</a><ol> </ol></li><li><a href="#section-References">References</a><ol> </ol></li><li><a href="#section-Edit History">Edit History</a><ol> </ol></li><li><a href="#section-Problem Description">Problem Description</a><ol> </ol></li><li><a href="#issue-tailp-nil:t">Proposal T</a><ol> </ol></li><li><a href="#section-Rationale">Rationale</a><ol> </ol></li><li><a href="#section-Examples">Examples</a><ol> </ol></li><li><a href="#section-Current Practice">Current Practice</a><ol> </ol></li><li><a href="#section-Cost to Implementors">Cost to Implementors</a><ol> </ol></li><li><a href="#section-Cost to Users">Cost to Users</a><ol> </ol></li><li><a href="#section-Benefits">Benefits</a><ol> </ol></li><li><a href="#section-Discussion">Discussion</a><ol> </ol></li></ol></nav><div class="content"><h1>X3J13 Issue TAILP-NIL [NIL] [CLARIFICATION/CHANGE]</h1><section id="section-Status" class="status-passed section"><h2 class="section-title">Status</h2>Passed, Jan 89 X3J13 </section><section id="section-References" class="section"><h2 class="section-title">References</h2><a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> (p275) </section><section id="section-Edit History" class="section"><h2 class="section-title">Edit History</h2>13-Sep-88, version 1 by Walter van Roggen, 13-Sep-88, version 2 by Pitman 18-Oct-88, version 3 by van Roggen (just one proposal) 01-Dec-88, version 4 by Pitman (minor edits per discussion) 9-Dec-88, Version 5 by Masinter (clarify <a class="function-reference" href="../chapter-5.xhtml#function-eql">eql</a>) </section><section id="section-Problem Description" class="section"><h2 class="section-title">Problem Description</h2>  CLtL <code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">p275</span>)</span>
</span></code> specifies <a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> as: <br/>    <a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> sublist list				[Function] <br/>    This predicate is true if SUBLIST is a sublist of <a class="function-reference" href="../chapter-14.xhtml#function-list">list</a> <pre><code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">i.e.</span><span class="syntax-interned-symbol">,
    one</span> <span class="syntax-interned-symbol">of</span> <a class="special-operator-reference" href="../chapter-3.xhtml#special-operator-the">the</a> <span class="syntax-interned-symbol">conses</span> <span class="syntax-interned-symbol">that</span> <span class="syntax-interned-symbol">makes</span> <span class="syntax-interned-symbol">up</span> <a class="function-reference" href="../chapter-14.xhtml#function-list">list</a>)</span>
</span></code></pre>; otherwise, it is false.     Another way to look at this is that <a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> is true if     <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-nthcdr">nthcdr</a> <span class="syntax-interned-symbol">n</span> <a class="function-reference" href="../chapter-14.xhtml#function-list">list</a>)</span>
</span></code> is SUBLIST, for some value of N. See <a class="function-reference" href="../chapter-14.xhtml#function-ldiff">ldiff</a>. <br/>  Two implementations of this definition might be: <br/>   <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="macro-reference" href="../chapter-5.xhtml#macro-defun">defun</a> <a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> <span class="syntax-cons">(<span class="syntax-interned-symbol">sublist</span> <a class="function-reference" href="../chapter-14.xhtml#function-list">list</a>)</span>			<span class="syntax-line-comment syntax-comment">;Definition "A"
</span>     <span class="syntax-cons">(<a class="macro-reference" href="../chapter-6.xhtml#macro-do">do</a> <span class="syntax-cons">(<span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-list">list</a> <a class="function-reference" href="../chapter-14.xhtml#function-list">list</a> <span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-cdr">cdr</a> <a class="function-reference" href="../chapter-14.xhtml#function-list">list</a>)</span>)</span>)</span>
	 <span class="syntax-cons">(<span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-endp">endp</a> <a class="function-reference" href="../chapter-14.xhtml#function-list">list</a>)</span> <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a>)</span>
       <span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-if">if</a> <span class="syntax-cons">(<a class="function-reference" href="../chapter-5.xhtml#function-eql">eql</a> <span class="syntax-interned-symbol">sublist</span> <a class="function-reference" href="../chapter-14.xhtml#function-list">list</a>)</span>
	   <span class="syntax-cons">(<a class="macro-reference" href="../chapter-5.xhtml#macro-return">return</a> <a class="proposal-reference" href="#issue-tailp-nil:t">T</a>)</span>)</span>)</span>)</span>
</span></code></pre> <br/>   <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="macro-reference" href="../chapter-5.xhtml#macro-defun">defun</a> <a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> <span class="syntax-cons">(<span class="syntax-interned-symbol">sublist</span> <a class="function-reference" href="../chapter-14.xhtml#function-list">list</a>)</span>			<span class="syntax-line-comment syntax-comment">;Definition "B"
</span>     <span class="syntax-cons">(<a class="macro-reference" href="../chapter-6.xhtml#macro-do">do</a> <span class="syntax-cons">(<span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-list">list</a> <a class="function-reference" href="../chapter-14.xhtml#function-list">list</a> <span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-cdr">cdr</a> <a class="function-reference" href="../chapter-14.xhtml#function-list">list</a>)</span>)</span>)</span>
	 <span class="syntax-cons">(<span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-atom">atom</a> <a class="function-reference" href="../chapter-14.xhtml#function-list">list</a>)</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-5.xhtml#function-eql">eql</a> <a class="function-reference" href="../chapter-14.xhtml#function-list">list</a> <span class="syntax-interned-symbol">sublist</span>)</span>)</span>
       <span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-if">if</a> <span class="syntax-cons">(<a class="function-reference" href="../chapter-5.xhtml#function-eql">eql</a> <span class="syntax-interned-symbol">sublist</span> <a class="function-reference" href="../chapter-14.xhtml#function-list">list</a>)</span>
	   <span class="syntax-cons">(<a class="macro-reference" href="../chapter-5.xhtml#macro-return">return</a> <a class="proposal-reference" href="#issue-tailp-nil:t">T</a>)</span>)</span>)</span>)</span>
</span></code></pre> <br/>  They differ only in their treatment of the atomic case. <br/>  At issue is the fact that <code><span class="syntax-root"><span class="syntax-symbol">()</span>
</span></code> is a list, and hence some would   argue that it is a sublist of all other lists. On the other hand,   the definition of <a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> seems to imply that being a cons is a   necessary precondition of being a "sublist". <br/>  Also at issue is the question of whether dotted lists are permissible   second arguments. <br/></section><section class="status-passed proposal" id="issue-tailp-nil:t"><h2 class="section-title">Proposal T</h2>  Strike any text in the definition of <a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> which suggests that a   sublist must be a cons. <br/>  Clarify that <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> <span class="syntax-interned-symbol">sublist</span> <a class="function-reference" href="../chapter-14.xhtml#function-list">list</a>)</span>
</span></code> returns true iff <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-nthcdr">nthcdr</a> <span class="syntax-interned-symbol">n</span> <a class="function-reference" href="../chapter-14.xhtml#function-list">list</a>)</span>
</span></code> is   sublist for some value of n, and false otherwise. <br/>  Note, however, that since the list may be dotted, so the end test   used by <a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> must be <a class="function-reference" href="../chapter-14.xhtml#function-atom">atom</a>, not <a class="function-reference" href="../chapter-14.xhtml#function-endp">endp</a>. That is, if <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> <span class="syntax-interned-symbol">x</span> <span class="syntax-interned-symbol">l</span>)</span>
</span></code>   returns true, it means there was n such that <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-nthcdr">nthcdr</a> <span class="syntax-interned-symbol">n</span> <a class="function-reference" href="../chapter-14.xhtml#function-list">list</a>)</span>
</span></code> would   return x; however, it doesn't follow that if <a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> returns false,   it is safe to go blithely <a class="function-reference" href="../chapter-14.xhtml#function-nthcdr">nthcdr</a>'s into the list looking for it,    since the list might be dotted and <a class="function-reference" href="../chapter-14.xhtml#function-nthcdr">nthcdr</a> might hit bad data. <br/>  Note that <a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> uses <a class="function-reference" href="../chapter-5.xhtml#function-eql">eql</a> or  equivalent to compare   sublist to list in the case where sublist is a number, etc. <br/></section><section id="section-Rationale" class="section"><h2 class="section-title">Rationale</h2>  This is more consistent with the definition of <a class="function-reference" href="../chapter-14.xhtml#function-ldiff">ldiff</a>, which   gives a useful meaning to arbitrary atomic SUBLIST arguments. <br/>  This gives a more elegant definition of SUBLIST, allowing it to   refer to any list &ndash; including the empty list &ndash; which is a   part of another list. <br/>  Some reasons for preferring an <a class="function-reference" href="../chapter-14.xhtml#function-atom">atom</a> check to <a class="function-reference" href="../chapter-14.xhtml#function-endp">endp</a> include:    <a class="function-reference" href="../chapter-12.xhtml#function--">-</a> The name <a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> suggests tails, not sublists. Some users might      expect this distinction to mean that data more general than      proper sublists.    <a class="function-reference" href="../chapter-12.xhtml#function--">-</a> Making <a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> require lists limits its usefulness. If we did      not make this choice, some users would end up having to write      their own extended <a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> which we could just as well have      provided compatibly.    <a class="function-reference" href="../chapter-12.xhtml#function--">-</a> <a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> is not considered to be used frequently enough in code      that the minor loss in speed to an <a class="function-reference" href="../chapter-14.xhtml#function-atom">atom</a> check is worth the      lost functionality. Indeed, expanding the scope of its       capabilities may lead to more uses for <a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a>.    <a class="function-reference" href="../chapter-12.xhtml#function--">-</a> Other operators (eg, <a class="function-reference" href="../chapter-14.xhtml#function-append">append</a>) have recently been extended to      treat dotted lists in an interesting way because users have      expressed a desire for this. As such, this change is       culturally consistent.    <a class="function-reference" href="../chapter-12.xhtml#function--">-</a> Some implementations already support this feature, and the       wording in CLtL is sufficiently ambiguous that some users      might think it appropriate to depend on the feature. In the      absence of compelling efficiency reasons to the contrary,      we should lean toward extending some implementations rather      than tightening others in our efforts to achieve cross-dialect      consistency. <br/></section><section id="section-Examples" class="section"><h2 class="section-title">Examples</h2><pre> #1: <code><span class="syntax-root"><span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-let">let</a> <span class="syntax-cons">(<span class="syntax-cons">(<span class="syntax-interned-symbol">X</span> <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span>)</span></span>)</span>)</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> <span class="syntax-interned-symbol">X</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-cons">cons</a> <span class="syntax-quote">'<span class="syntax-interned-symbol">A</span></span> <span class="syntax-interned-symbol">X</span>)</span>)</span>)</span>
</span></code><br/>     should return <a class="proposal-reference" href="#issue-tailp-nil:t">T</a> in all implementations.<br/><br/> #2: <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">X</span> <span class="syntax-interned-symbol">Y</span>)</span></span> <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span>)</span></span>)</span>
</span></code><br/>     should return <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a> in all implementations.<br/><br/> #3: <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> <span class="syntax-quote">'<span class="syntax-symbol">()</span></span> <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span>)</span></span>)</span>
</span></code><br/>     returns <a class="proposal-reference" href="#issue-tailp-nil:t">T</a> under this proposal.<br/><br/> #4: <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> <span class="syntax-number">3</span> <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span>)</span></span>)</span>
</span></code><br/>     returns <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a> under this proposal.<br/><br/> #5: <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> <span class="syntax-number">3</span> <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span> <span class="syntax-symbol">.</span> <span class="syntax-number">3</span>)</span></span>)</span>
</span></code><br/>     returns <a class="proposal-reference" href="#issue-tailp-nil:t">T</a> under this proposal.<br/><br/> #6: <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">X</span> <span class="syntax-interned-symbol">Y</span>)</span></span> <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-interned-symbol">A</span> <span class="syntax-interned-symbol">B</span> <span class="syntax-interned-symbol">C</span> <span class="syntax-symbol">.</span> <span class="syntax-number">3</span>)</span></span>)</span>
</span></code><br/>     returns <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a> under this proposal.<br/><br/></pre></section><section id="section-Current Practice" class="section"><h2 class="section-title">Current Practice</h2>  Symbolics Genera is consistent with <a class="issue-reference" href="#issue-tailp-nil:t">TAILP-NIL:T</a>. <br/>  Neither Lucid nor VAX <a class="package-reference" href="../chapter-A.xhtml#package-lisp">lisp</a> currently implements <a class="issue-reference" href="#issue-tailp-nil:t">TAILP-NIL:T</a>. <br/>  VAX <a class="package-reference" href="../chapter-A.xhtml#package-lisp">lisp</a> effectively implements definition "A" from the    Problem Description above. <br/></section><section id="section-Cost to Implementors" class="section"><h2 class="section-title">Cost to Implementors</h2>  An implementation of <a class="issue-reference" href="#issue-tailp-nil:t">TAILP-NIL:T</a> is given as Definition "B" in the   problem description. <br/>  Some implementations might have compiler optimizers for these definitions   as well, so a slight amount of additional effort might be required. <br/></section><section id="section-Cost to Users" class="section"><h2 class="section-title">Cost to Users</h2>  Given that current practice varies widely on the disputed case,   this is unlikely to have a practical effect on existing portable code. <br/></section><section id="section-Benefits" class="section"><h2 class="section-title">Benefits</h2>  Avoids unnecessary incompatibilities between implementations. <br/>Non-Benefits: <br/>  Slows down <a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> slightly in some implementations because <a class="function-reference" href="../chapter-14.xhtml#function-endp">endp</a> is   potentially faster than <a class="function-reference" href="../chapter-14.xhtml#function-atom">atom</a>. <br/></section><section id="section-Discussion" class="section"><h2 class="section-title">Discussion</h2>  This issue was first raised in "&gt;GLS&gt;clarifications.text" of 12/06/85.   It recommended an earlier proposal, <span class="issue-reference error">issue:TAILP-NIL:NIL</span>, which is effectively   equivalent to Definition "A" from the Problem Description. <br/>  Pitman introduced <a class="issue-reference" href="#issue-tailp-nil:t">TAILP-NIL:T</a> as an alternative, arguing that the   definition <span class="issue-reference error">issue:TAILP-NIL:NIL</span> offered no practical value to programmers   in the disputed situations, while <a class="issue-reference" href="#issue-tailp-nil:t">TAILP-NIL:T</a> was of arguable usefulness. <br/>  Pitman and van Roggen support <a class="issue-reference" href="#issue-tailp-nil:t">TAILP-NIL:T</a>. <br/>  It was suggested more than once by more than one cleanup    committee member that we remove <a class="function-reference" href="../chapter-14.xhtml#function-tailp">tailp</a> from the language   "since almost nobody uses it".  </section></div></main><footer>Copyright © 2021 Jan Moringen</footer></body></html>