<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
  "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><link rel="stylesheet" type="text/css" href="../style.css"/><script src="../permalink.js"/><script src="../navigation.js"/><title>Well-specified Common Lisp â€” PRINT-CASE-PRINT-ESCAPE-INTERACTION</title></head><body><main><nav class="sidebar"><span class="name">Entry Points</span><br/><ol><li><a href="../chap-0.xhtml#section-Figures">Table of Contents</a></li><li><a href="../symbol-index.xhtml#section-SymbolIndex">Symbol Index</a></li><li><a href="../figure-index.xhtml#section-FigureIndex">Figure Index</a></li><li><a href="../issue-index.xhtml#section-IssueIndices">Issue Index</a></li><li><a href="../note-indices.xhtml#section-ReviewerNoteIndex">Note Indices</a></li><li><a href="../chapter-26.xhtml#section-Glossary">Glossary</a></li></ol><hr/><span class="name">PRINT-CASE-PRINT-ESCAPE-INTERACTION</span><br/><ol class="local-toc"><li><a href="#section-Status">Status</a><ol> </ol></li><li><a href="#section-References">References</a><ol> </ol></li><li><a href="#section-Edit history">Edit history</a><ol> </ol></li><li><a href="#section-Problem Description">Problem Description</a><ol> </ol></li><li><a href="#issue-print-case-print-escape-interaction:like-prin1">Proposal LIKE-PRIN1</a><ol> </ol></li><li><a href="#issue-print-case-print-escape-interaction:like-write-string">Proposal LIKE-WRITE-STRING</a><ol> </ol></li><li><a href="#issue-print-case-print-escape-interaction:vertical-bar-rule-no-upcase">Proposal VERTICAL-BAR-RULE-NO-UPCASE</a><ol> </ol></li><li><a href="#issue-print-case-print-escape-interaction:vertical-bar-rule-permit-upcase">Proposal VERTICAL-BAR-RULE-PERMIT-UPCASE</a><ol> </ol></li><li><a href="#issue-print-case-print-escape-interaction:explicitly-vague">Proposal EXPLICITLY-VAGUE</a><ol> </ol></li><li><a href="#section-Test Case">Test Case</a><ol> </ol></li><li><a href="#section-Rationale">Rationale</a><ol> </ol></li><li><a href="#section-Current Practice">Current Practice</a><ol> </ol></li><li><a href="#section-Cost to Implementors">Cost to Implementors</a><ol> </ol></li><li><a href="#section-Cost to Users">Cost to Users</a><ol> </ol></li><li><a href="#section-Cost of Non-Adoption">Cost of Non-Adoption</a><ol> </ol></li><li><a href="#section-Benefits">Benefits</a><ol> </ol></li><li><a href="#section-Aesthetics">Aesthetics</a><ol> </ol></li><li><a href="#section-Discussion">Discussion</a><ol> </ol></li></ol></nav><div class="content"><h1>X3J13 Issue PRINT-CASE-PRINT-ESCAPE-INTERACTION [Cleanup] [CLARIFICATION]</h1><section id="section-Status" class="status-passed section"><h2 class="section-title">Status</h2>proposal <a class="proposal-reference" href="#issue-print-case-print-escape-interaction:vertical-bar-rule-no-upcase">VERTICAL-BAR-RULE-NO-UPCASE</a> passed, Jun 89 X3J13 </section><section id="section-References" class="section"><h2 class="section-title">References</h2><a class="variable-reference" href="../chapter-22.xhtml#variable-*print-escape*">*PRINT-ESCAPE*</a> (pp370-371), <a class="variable-reference" href="../chapter-22.xhtml#variable-*print-case*">*PRINT-CASE*</a> (pp372), <a class="function-reference" href="../chapter-22.xhtml#function-write">WRITE</a> </section><section id="section-Edit history" class="section"><h2 class="section-title">Edit history</h2>26-Jan-89, Version 1 by Pitman </section><section id="section-Problem Description" class="section"><h2 class="section-title">Problem Description</h2>  The wording on page 372 of CLtL uses fuzzy terms that make it hard   to tell if <a class="variable-reference" href="../chapter-22.xhtml#variable-*print-escape*">*PRINT-ESCAPE*</a> interacts with <a class="variable-reference" href="../chapter-22.xhtml#variable-*print-case*">*PRINT-CASE*</a>. <br/>  Paragraph 1 of the description of <a class="variable-reference" href="../chapter-22.xhtml#variable-*print-case*">*PRINT-CASE*</a> says "This variable   controls the case (upper, lower, or mixed) in which to print any   uppercase characters in the names of symbols when <a class="glossary-reference" href="../chapter-26.xhtml#glossary-vertical-bar">vertical-bar</a>   syntax is used." <br/>  Paragraph 2 begins with the seemingly unambiguous statement "Lowercase   characters in the internal print name are always printed in lowercase"   but then goes on to muddy the water by saying "and are preceded by   a single escape character or enclosed by multiple escape characters".   This escaping presumably only happens in <a class="variable-reference" href="../chapter-22.xhtml#variable-*print-escape*">*PRINT-ESCAPE*</a> <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a> mode, which   leads one to wonder if other parts of the <a class="variable-reference" href="../chapter-22.xhtml#variable-*print-escape*">*PRINT-ESCAPE*</a> description are   implicitly controlled by <a class="variable-reference" href="../chapter-22.xhtml#variable-*print-escape*">*PRINT-ESCAPE*</a> as well. <br/>  The function <a class="function-reference" href="../chapter-22.xhtml#function-write">WRITE</a> is affected by implication. <br/></section><section class="status-unknown proposal" id="issue-print-case-print-escape-interaction:like-prin1"><h2 class="section-title">Proposal LIKE-PRIN1</h2>  Define that <a class="variable-reference" href="../chapter-22.xhtml#variable-*print-case*">*PRINT-CASE*</a> cases characters the same as <a class="function-reference" href="../chapter-22.xhtml#function-prin1">PRIN1</a> would. <br/></section><section class="status-unknown proposal" id="issue-print-case-print-escape-interaction:like-write-string"><h2 class="section-title">Proposal LIKE-WRITE-STRING</h2>  Define that <a class="variable-reference" href="../chapter-22.xhtml#variable-*print-case*">*PRINT-CASE*</a> has an effect only when <a class="variable-reference" href="../chapter-22.xhtml#variable-*print-escape*">*PRINT-ESCAPE*</a> is <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a>.   When <a class="variable-reference" href="../chapter-22.xhtml#variable-*print-case*">*PRINT-CASE*</a> is <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a>, <a class="function-reference" href="../chapter-21.xhtml#function-write-string">WRITE-STRING</a> is used directly. <br/></section><section class="status-passed proposal" id="issue-print-case-print-escape-interaction:vertical-bar-rule-no-upcase"><h2 class="section-title">Proposal VERTICAL-BAR-RULE-NO-UPCASE</h2>  Define that <a class="variable-reference" href="../chapter-22.xhtml#variable-*print-case*">*PRINT-CASE*</a> has an effect at all times when <a class="variable-reference" href="../chapter-22.xhtml#variable-*print-escape*">*PRINT-ESCAPE*</a>   is <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a>. Define that <a class="variable-reference" href="../chapter-22.xhtml#variable-*print-case*">*PRINT-CASE*</a> also has an effect when <a class="variable-reference" href="../chapter-22.xhtml#variable-*print-escape*">*PRINT-ESCAPE*</a>   is <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a> unless inside an escape context (i.e., unless between vertical bars   or after a slash). Under no circumstance is any character which was    lowercase in the internal representation ever presented as uppercase   due to <a class="variable-reference" href="../chapter-22.xhtml#variable-*print-case*">*PRINT-CASE*</a>. <br/></section><section class="status-unknown proposal" id="issue-print-case-print-escape-interaction:vertical-bar-rule-permit-upcase"><h2 class="section-title">Proposal VERTICAL-BAR-RULE-PERMIT-UPCASE</h2>  Like <a class="proposal-reference" href="#issue-print-case-print-escape-interaction:vertical-bar-rule-no-upcase">VERTICAL-BAR-RULE-NO-UPCASE</a>, but permit <a class="variable-reference" href="../chapter-22.xhtml#variable-*print-case*">*PRINT-CASE*</a> to upcase   lowercase characters in the <a class="variable-reference" href="../chapter-22.xhtml#variable-*print-escape*">*PRINT-ESCAPE*</a> <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a> case since preservation of   Lisp syntax is not important there. <br/></section><section class="status-unknown proposal" id="issue-print-case-print-escape-interaction:explicitly-vague"><h2 class="section-title">Proposal EXPLICITLY-VAGUE</h2>  Specify that the effect of <a class="variable-reference" href="../chapter-22.xhtml#variable-*print-case*">*PRINT-CASE*</a> when <a class="variable-reference" href="../chapter-22.xhtml#variable-*print-escape*">*PRINT-ESCAPE*</a> is <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a>   is <a class="glossary-reference" href="../chapter-26.xhtml#glossary-implementation-dependent">implementation-dependent</a>. <br/></section><section id="section-Test Case" class="section"><h2 class="section-title">Test Case</h2><pre>  (<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-let">LET</a> <code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-cons">(<span class="syntax-interned-symbol">RESULT</span> <span class="syntax-quote">'<span class="syntax-symbol">()</span></span>)</span> <span class="syntax-cons">(<span class="syntax-interned-symbol">TABWIDTH</span> <span class="syntax-number">12</span>)</span>)</span>
</span></code><br/>    (<a class="macro-reference" href="../chapter-6.xhtml#macro-dolist">DOLIST</a> (<a class="symbol-reference" href="../chapter-2.xhtml#symbol-symbol">SYMBOL</a> '(|x| |FoObAr| |fOo|))<br/>      <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-let">LET</a> <span class="syntax-cons">(<span class="syntax-cons">(<span class="syntax-interned-symbol">TAB</span> <span class="syntax-number">-1</span>)</span>)</span>
	<span class="syntax-cons">(<a class="function-reference" href="../chapter-22.xhtml#function-format">FORMAT</a> <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a> <span class="syntax-string">"~&amp;"</span>)</span>
	<span class="syntax-cons">(<a class="macro-reference" href="../chapter-6.xhtml#macro-dolist">DOLIST</a> <span class="syntax-cons">(<span class="syntax-interned-symbol">ESCAPE</span> <span class="syntax-quote">'<span class="syntax-cons">(<a class="section-reference" href="../chapter-26.xhtml#section-T">T</a> <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a>)</span></span>)</span>
	  <span class="syntax-cons">(<a class="macro-reference" href="../chapter-6.xhtml#macro-dolist">DOLIST</a> <span class="syntax-cons">(<a class="macro-reference" href="../chapter-5.xhtml#macro-case">CASE</a> <span class="syntax-quote">'<span class="syntax-cons">(<span class="syntax-keyword-symbol">:UPCASE</span> <span class="syntax-keyword-symbol">:DOWNCASE</span> <span class="syntax-keyword-symbol">:CAPITALIZE</span>)</span></span>)</span>
	    <span class="syntax-cons">(<a class="function-reference" href="../chapter-22.xhtml#function-format">FORMAT</a> <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a> <span class="syntax-string">"~VT"</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-12.xhtml#function-*">*</a> <span class="syntax-cons">(<a class="macro-reference" href="../chapter-12.xhtml#macro-incf">INCF</a> <span class="syntax-interned-symbol">TAB</span>)</span> <span class="syntax-interned-symbol">TABWIDTH</span>)</span>)</span>
 	    <span class="syntax-cons">(<a class="function-reference" href="../chapter-22.xhtml#function-write">WRITE</a> <a class="symbol-reference" href="../chapter-2.xhtml#symbol-symbol">SYMBOL</a> <span class="syntax-keyword-symbol">:ESCAPE</span> <span class="syntax-interned-symbol">ESCAPE</span> <span class="syntax-keyword-symbol">:CASE</span> <a class="macro-reference" href="../chapter-5.xhtml#macro-case">CASE</a>)</span>)</span>)</span>)</span>
</span></code></pre>))<br/><br/>  For each of the following, two clusters of output is shown. The first is<br/>  how an implementation which leans heavily on vertical bars might work.<br/>  The second is how an implementation which leans heavily on slash might<br/>  work. In fact, other interpretations are possible <pre><code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">mixing</span> <span class="syntax-interned-symbol">slash</span> <a class="macro-reference" href="../chapter-5.xhtml#macro-and">and</a> 
  <span class="syntax-interned-symbol">vertical</span> <span class="syntax-interned-symbol">bar</span>)</span>
</span></code></pre>. These examples are not an exhaustive analysis of the <br/>  implications of each proposal.<br/><br/>  Possible outputs under <a class="proposal-reference" href="#issue-print-case-print-escape-interaction:like-prin1">LIKE-PRIN1</a>:<br/><br/>  |x|        |x|         |x|         x           x           x<br/>  |FoObAr|   |FoObAr|    |FoObAr|    FoObAr      FoObAr      FoObAr<br/>  |fOo|      |fOo|       |fOo|       fOo         fOo         fOo<br/><br/>  \x         \x          \x          x           x           x<br/>  F\oO\bA\r  f\oo\ba\r   F\oo\ba\r   FoObAr      foobar      Foobar   <br/>  \fO\o      \fo\o       \fo\o       fOo         foo         foo<br/><br/>  Possible output under <a class="proposal-reference" href="#issue-print-case-print-escape-interaction:like-write-string">LIKE-WRITE-STRING</a>:<br/><br/>  |x|        |x|         |x|         x           x           x<br/>  |FoObAr|   |FoObAr|    |FoObAr|    FoObAr      FoObAr      FoObAr<br/>  |fOo|      |fOo|       |fOo|       fOo         fOo         fOo<br/><br/>  \x         \x          \x          x           x           x<br/>  F\oO\bA\r  f\oo\ba\r   F\oo\ba\r   FoObAr      FoObAr      FoObAr<br/>  \fO\o      \fo\o       \fo\o       fOo         fOo         fOo<br/><br/>  Possible output under <a class="proposal-reference" href="#issue-print-case-print-escape-interaction:vertical-bar-rule-no-upcase">VERTICAL-BAR-RULE-NO-UPCASE</a>:<br/><br/>  |x|        |x|         |x|         x           x           x<br/>  |FoObAr|   |FoObAr|    |FoObAr|    FoObAr      foobar      Foobar<br/>  |fOo|      |fOo|       |fOo|       fOo         foo         foo<br/><br/>  \x         \x          \x          x           x           x<br/>  F\oO\bA\r  f\oo\ba\r   F\oo\ba\r   FoObAr      foobar      Foobar<br/>  \fO\o      \fo\o       \fo\o       fOo         foo         foo<br/><br/>  Possible output under <a class="proposal-reference" href="#issue-print-case-print-escape-interaction:vertical-bar-rule-permit-upcase">VERTICAL-BAR-RULE-PERMIT-UPCASE</a>:<br/><br/>  |x|        |x|         |x|         X           x           X<br/>  |FoObAr|   |FoObAr|    |FoObAr|    FOOBAR      foobar      Foobar<br/>  |fOo|      |fOo|       |fOo|       <a class="index/code-reference" href="../chapter-1.xhtml#index/code-foo">FOO</a>         foo         Foo<br/><br/>  \x         \x          \x          X           x           X<br/>  F\oO\bA\r  f\oo\ba\r   F\oo\ba\r   FOOBAR      foobar      Foobar<br/>  \fO\o      \fO\o       \fO\o       <a class="index/code-reference" href="../chapter-1.xhtml#index/code-foo">FOO</a>         foo         Foo<br/><br/></pre></section><section id="section-Rationale" class="section"><h2 class="section-title">Rationale</h2>  It's silly for implementations to vary on this point. <br/></section><section id="section-Current Practice" class="section"><h2 class="section-title">Current Practice</h2>  A strict reading of CLtL suggests that probably <a class="proposal-reference" href="#issue-print-case-print-escape-interaction:vertical-bar-rule-no-upcase">VERTICAL-BAR-RULE-NO-UPCASE</a>   is the most correct.  <br/>  Symbolics Genera doesn't do any of these. It was trying to do    VERTICAL-BAR-NO-UPCASE, but it had a bug which was about to be fixed when   this issue was raised. <br/></section><section id="section-Cost to Implementors" class="section"><h2 class="section-title">Cost to Implementors</h2>  Probably trivial. <br/></section><section id="section-Cost to Users" class="section"><h2 class="section-title">Cost to Users</h2>  Negligible in most cases. Probably very few users depend on this.   Those who do depend on it probably do so because they think the   behavior doesn't vary and probably don't get the portable behavior they   expect. <br/></section><section id="section-Cost of Non-Adoption" class="section"><h2 class="section-title">Cost of Non-Adoption</h2>  Gratuitous variation between implementations. <br/></section><section id="section-Benefits" class="section"><h2 class="section-title">Benefits</h2>  Cost of non-adoption is avoided. <br/></section><section id="section-Aesthetics" class="section"><h2 class="section-title">Aesthetics</h2>  Anything that makes the language tighter probably improves aesthetics. <br/>  Only <a class="proposal-reference" href="#issue-print-case-print-escape-interaction:vertical-bar-rule-permit-upcase">VERTICAL-BAR-RULE-PERMIT-UPCASE</a> and <a class="proposal-reference" href="#issue-print-case-print-escape-interaction:like-write-string">LIKE-WRITE-STRING</a> have really   useful behaviors in the :ESCAPE <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a> situation. Of these, perhaps only   <a class="proposal-reference" href="#issue-print-case-print-escape-interaction:vertical-bar-rule-permit-upcase">VERTICAL-BAR-RULE-PERMIT-UPCASE</a> is really visually pleasant. <br/></section><section id="section-Discussion" class="section"><h2 class="section-title">Discussion</h2>  Pitman doesn't think the particular choice is very important. He just   wants the issue to be resolved. His slight preference is for   <a class="proposal-reference" href="#issue-print-case-print-escape-interaction:vertical-bar-rule-permit-upcase">VERTICAL-BAR-RULE-PERMIT-UPCASE</a>, then <a class="proposal-reference" href="#issue-print-case-print-escape-interaction:like-write-string">LIKE-WRITE-STRING</a>, then either   of <a class="proposal-reference" href="#issue-print-case-print-escape-interaction:like-prin1">LIKE-PRIN1</a> or <a class="proposal-reference" href="#issue-print-case-print-escape-interaction:vertical-bar-rule-no-upcase">VERTICAL-BAR-RULE-NO-UPCASE</a>. He sees no reason to go   with <a class="proposal-reference" href="#issue-print-case-print-escape-interaction:explicitly-vague">EXPLICITLY-VAGUE</a> unless we deadlock. <br/>  Michael Greenwald, who raised the issue at Symbolics, doesn't have   a preference either but believes that CLtL <code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">perhaps</span> <span class="syntax-interned-symbol">unintentionally</span>)</span>
</span></code>   leans toward <a class="proposal-reference" href="#issue-print-case-print-escape-interaction:vertical-bar-rule-no-upcase">VERTICAL-BAR-RULE-NO-UPCASE</a>. <br/>&mdash;&ndash; Additional Discussion from CL-Cleanup: <br/>  David Gray responds:     &gt;   Possible output under <a class="proposal-reference" href="#issue-print-case-print-escape-interaction:vertical-bar-rule-no-upcase">VERTICAL-BAR-RULE-NO-UPCASE</a>:     &gt;      &gt;   |x|        |x|         |x|         x           x           x     &gt;   |FoObAr|   |FoObAr|    |FoObAr|    FoObAr      foobar      Foobar     &gt;   |fOo|      |fOo|       |fOo|       fOo         foo         foo     This is exactly what the Explorer does. <br/>There are several options for this issue, but if you're looking for one to focus on, <a class="proposal-reference" href="#issue-print-case-print-escape-interaction:vertical-bar-rule-no-upcase">VERTICAL-BAR-RULE-NO-UPCASE</a> is probably the one we'll push if this issue comes up for discussion since it is believed most compatible with current practice.  -kmp <br/>  </section></div></main><footer>Copyright Â© 2021 Jan Moringen</footer></body></html>