<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
  "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><link rel="stylesheet" type="text/css" href="../style.css"/><script src="../permalink.js"/><script src="../navigation.js"/><title>Well-specified Common Lisp — ADJUST-ARRAY-FILL-POINTER</title></head><body><main><nav class="sidebar"><span class="name">Entry Points</span><br/><ol><li><a href="../chap-0.xhtml#section-Figures">Table of Contents</a></li><li><a href="../symbol-index.xhtml#section-SymbolIndex">Symbol Index</a></li><li><a href="../figure-index.xhtml#section-FigureIndex">Figure Index</a></li><li><a href="../issue-index.xhtml#section-IssueIndices">Issue Index</a></li><li><a href="../note-indices.xhtml#section-ReviewerNoteIndex">Note Indices</a></li><li><a href="../chapter-26.xhtml#section-Glossary">Glossary</a></li></ol><hr/><span class="name">ADJUST-ARRAY-FILL-POINTER</span><br/><ol class="local-toc"><li><a href="#section-Status">Status</a><ol> </ol></li><li><a href="#section-References">References</a><ol> </ol></li><li><a href="#section-Edit history">Edit history</a><ol> </ol></li><li><a href="#section-Problem Description">Problem Description</a><ol> </ol></li><li><a href="#issue-adjust-array-fill-pointer:minimal">Proposal MINIMAL</a><ol> </ol></li><li><a href="#section-Test Case">Test Case</a><ol> </ol></li><li><a href="#section-Rationale">Rationale</a><ol> </ol></li><li><a href="#section-Current Practice">Current Practice</a><ol> </ol></li><li><a href="#section-Cost to Implementors">Cost to Implementors</a><ol> </ol></li><li><a href="#section-Cost to Users">Cost to Users</a><ol> </ol></li><li><a href="#section-Cost of Non-Adoption">Cost of Non-Adoption</a><ol> </ol></li><li><a href="#section-Benefits">Benefits</a><ol> </ol></li><li><a href="#section-Aesthetics">Aesthetics</a><ol> </ol></li><li><a href="#section-Discussion">Discussion</a><ol> </ol></li></ol></nav><div class="content"><h1>X3J13 Issue ADJUST-ARRAY-FILL-POINTER [NIL] [CLARIFICATION]</h1><section id="section-Status" class="status-passed section"><h2 class="section-title">Status</h2>passed, 1988 (not sure which meeting) </section><section id="section-References" class="section"><h2 class="section-title">References</h2><a class="function-reference" href="../chapter-15.xhtml#function-adjust-array">adjust-array</a> (p297) </section><section id="section-Edit history" class="section"><h2 class="section-title">Edit history</h2>15-Mar-88, Version 1 by Pitman </section><section id="section-Problem Description" class="section"><h2 class="section-title">Problem Description</h2>  CLtL does not specify clearly the effect of <a class="function-reference" href="../chapter-15.xhtml#function-adjust-array">adjust-array</a> on the fill   pointer. <br/></section><section class="status-passed proposal" id="issue-adjust-array-fill-pointer:minimal"><h2 class="section-title">Proposal MINIMAL</h2>  Clarify that the :FILL-POINTER keyword argument to <a class="function-reference" href="../chapter-15.xhtml#function-adjust-array">adjust-array</a> is treated   as follows... <br/>  If :FILL-POINTER argument is not given, then the <a class="function-reference" href="../chapter-15.xhtml#function-fill-pointer">fill-pointer</a> of the array   to be adjusted <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-if">if</a> <span class="syntax-interned-symbol">any</span>)</span>
</span></code></pre> is left alone. It is an error to adjust an array   to a size smaller than its fill pointer without specifying the :FILL-POINTER   option so that its <a class="function-reference" href="../chapter-15.xhtml#function-fill-pointer">fill-pointer</a> is properly adjusted in the process. <br/>  If supplied, the :FILL-POINTER argument must be either an integer between 0   and the new size of the array, the symbol <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a> <pre><code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">indicating</span> <span class="syntax-interned-symbol">that</span> <a class="special-operator-reference" href="../chapter-3.xhtml#special-operator-the">the</a> <span class="syntax-interned-symbol">new</span> <span class="syntax-interned-symbol">size</span>
  <span class="syntax-interned-symbol">of</span> <a class="special-operator-reference" href="../chapter-3.xhtml#special-operator-the">the</a> <a class="symbol-reference" href="../chapter-2.xhtml#symbol-array">array</a> <span class="syntax-interned-symbol">should</span> <span class="syntax-interned-symbol">be</span> <span class="syntax-interned-symbol">used</span>)</span>
</span></code></pre>, or the symbol <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a> (indicating that the fill   pointer should left as it is &ndash; as if the :FILL-POINTER option had not been   specified). <br/>  An error is signalled if a <a class="glossary-reference" href="../chapter-26.xhtml#glossary-non-nil">non-nil</a> value for :FILL-POINTER is supplied and   the array to be adjusted does not already have a fill pointer. <br/></section><section id="section-Test Case" class="section"><h2 class="section-title">Test Case</h2><pre>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-setq">setq</a> <span class="syntax-interned-symbol">A1</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-15.xhtml#function-make-array">make-array</a> <span class="syntax-number">5</span> <span class="syntax-keyword-symbol">:FILL-POINTER</span> <span class="syntax-number">3</span> <span class="syntax-keyword-symbol">:ADJUSTABLE</span> <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a>)</span>)</span>
</span></code></pre><br/>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-setq">setq</a> <span class="syntax-interned-symbol">A2</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-15.xhtml#function-adjust-array">adjust-array</a> <span class="syntax-interned-symbol">A1</span> <span class="syntax-number">4</span>)</span>)</span>
</span></code></pre><br/>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-15.xhtml#function-fill-pointer">fill-pointer</a> <span class="syntax-interned-symbol">A1</span>)</span>
</span></code></pre> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; 3<br/>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-15.xhtml#function-fill-pointer">fill-pointer</a> <span class="syntax-interned-symbol">A2</span>)</span>
</span></code></pre> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; 3<br/><br/>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-setq">setq</a> <span class="syntax-interned-symbol">B1</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-15.xhtml#function-make-array">make-array</a> <span class="syntax-number">5</span> <span class="syntax-keyword-symbol">:FILL-POINTER</span> <span class="syntax-number">3</span> <span class="syntax-keyword-symbol">:ADJUSTABLE</span> <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a>)</span>)</span>
</span></code></pre><br/>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-setq">setq</a> <span class="syntax-interned-symbol">B2</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-15.xhtml#function-adjust-array">adjust-array</a> <span class="syntax-interned-symbol">B1</span> <span class="syntax-number">2</span> <span class="syntax-keyword-symbol">:FILL-POINTER</span> <span class="syntax-number">1</span>)</span>)</span>
</span></code></pre><br/>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-15.xhtml#function-fill-pointer">fill-pointer</a> <span class="syntax-interned-symbol">B1</span>)</span>
</span></code></pre> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; 1<br/>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-15.xhtml#function-fill-pointer">fill-pointer</a> <span class="syntax-interned-symbol">B2</span>)</span>
</span></code></pre> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; 1<br/><br/>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-setq">setq</a> <span class="syntax-interned-symbol">C1</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-15.xhtml#function-make-array">make-array</a> <span class="syntax-number">5</span> <span class="syntax-keyword-symbol">:FILL-POINTER</span> <span class="syntax-number">3</span> <span class="syntax-keyword-symbol">:ADJUSTABLE</span> <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a>)</span>)</span>
</span></code></pre><br/>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-setq">setq</a> <span class="syntax-interned-symbol">C2</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-15.xhtml#function-adjust-array">adjust-array</a> <span class="syntax-interned-symbol">C1</span> <span class="syntax-number">2</span> <span class="syntax-keyword-symbol">:FILL-POINTER</span> <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a>)</span>)</span>
</span></code></pre><br/>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-15.xhtml#function-fill-pointer">fill-pointer</a> <span class="syntax-interned-symbol">C1</span>)</span>
</span></code></pre> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; 2<br/>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-15.xhtml#function-fill-pointer">fill-pointer</a> <span class="syntax-interned-symbol">C2</span>)</span>
</span></code></pre> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; 2<br/><br/>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-setq">setq</a> <span class="syntax-interned-symbol">D1</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-15.xhtml#function-make-array">make-array</a> <span class="syntax-number">5</span> <span class="syntax-keyword-symbol">:ADJUSTABLE</span> <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a>)</span>)</span>
</span></code></pre><br/>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-setq">setq</a> <span class="syntax-interned-symbol">D2</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-15.xhtml#function-adjust-array">adjust-array</a> <span class="syntax-interned-symbol">D1</span> <span class="syntax-number">2</span> <span class="syntax-keyword-symbol">:FILL-POINTER</span> <span class="syntax-number">2</span>)</span>)</span>
</span></code></pre> signals an error.<br/><br/>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-setq">setq</a> <span class="syntax-interned-symbol">E1</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-15.xhtml#function-make-array">make-array</a> <span class="syntax-number">5</span> <span class="syntax-keyword-symbol">:FILL-POINTER</span> <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a> <span class="syntax-keyword-symbol">:ADJUSTABLE</span> <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a>)</span>)</span>
</span></code></pre><br/>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-setq">setq</a> <span class="syntax-interned-symbol">E2</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-15.xhtml#function-adjust-array">adjust-array</a> <span class="syntax-interned-symbol">E1</span> <span class="syntax-number">4</span>)</span>)</span>
</span></code></pre> is an error.<br/><br/></pre></section><section id="section-Rationale" class="section"><h2 class="section-title">Rationale</h2>  This behavior must be more clearly defined if portable programs are going   to be able to depend on it. <br/></section><section id="section-Current Practice" class="section"><h2 class="section-title">Current Practice</h2>  Symbolics Lisp implements the proposal. In case "E", it does not signal an   error. It simply leaves the illegal <a class="function-reference" href="../chapter-15.xhtml#function-fill-pointer">fill-pointer</a> in place so that the   programmer can correct it using <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="macro-reference" href="../chapter-5.xhtml#macro-setf">setf</a> <span class="syntax-cons">(<a class="function-reference" href="../chapter-15.xhtml#function-fill-pointer">fill-pointer</a> <span class="syntax-interned-symbol">E2</span>)</span> <span class="syntax-interned-symbol">...</span>)</span>
</span></code></pre> <br/></section><section id="section-Cost to Implementors" class="section"><h2 class="section-title">Cost to Implementors</h2>  Probably most implementations do not deviate significantly from the proposed   behavior. The cost to implementors is probably very slight. <br/></section><section id="section-Cost to Users" class="section"><h2 class="section-title">Cost to Users</h2>  None. This clarifies a fuzzy area in the manual which users cannot currently   depend upon. <br/></section><section id="section-Cost of Non-Adoption" class="section"><h2 class="section-title">Cost of Non-Adoption</h2>  The interaction between <a class="function-reference" href="../chapter-15.xhtml#function-adjust-array">adjust-array</a> and fill-pointers would continue to be   hazy, and portable programs would not be able to rely upon that behavior   being consistent across implementations. <br/></section><section id="section-Benefits" class="section"><h2 class="section-title">Benefits</h2>  The cost of non-adoption would be avoided. <br/></section><section id="section-Aesthetics" class="section"><h2 class="section-title">Aesthetics</h2>  There is little if any aesthetic impact of this change. <br/></section><section id="section-Discussion" class="section"><h2 class="section-title">Discussion</h2>  Pitman volunteered to write this issue up for the Cleanup committee. He's   not very passionate about the details one way or another, but figures it's   a good idea that they be clarified. <br/>   The cleanup committee didn't object. </section></div></main><footer>Copyright © 2021 Jan Moringen</footer></body></html>