<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
  "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><link rel="stylesheet" type="text/css" href="../style.css"/><script src="../permalink.js"/><script src="../navigation.js"/><title>Well-specified Common Lisp — DATA-TYPES-HIERARCHY-UNDERSPECIFIED</title></head><body><main><nav class="sidebar"><span class="name">Entry Points</span><br/><ol><li><a href="../chap-0.xhtml#section-Figures">Table of Contents</a></li><li><a href="../symbol-index.xhtml#section-SymbolIndex">Symbol Index</a></li><li><a href="../figure-index.xhtml#section-FigureIndex">Figure Index</a></li><li><a href="../issue-index.xhtml#section-IssueIndices">Issue Index</a></li><li><a href="../note-indices.xhtml#section-ReviewerNoteIndex">Note Indices</a></li><li><a href="../chapter-26.xhtml#section-Glossary">Glossary</a></li></ol><hr/><span class="name">DATA-TYPES-HIERARCHY-UNDERSPECIFIED</span><br/><ol class="local-toc"><li><a href="#section-Status">Status</a><ol> </ol></li><li><a href="#section-References">References</a><ol> </ol></li><li><a href="#section-Edit history">Edit history</a><ol> </ol></li><li><a href="#section-Problem description">Problem description</a><ol> </ol></li><li><a href="#issue-data-types-hierarchy-underspecified:disjoint">Proposal DISJOINT</a><ol> </ol></li><li><a href="#section-Rationale">Rationale</a><ol> </ol></li><li><a href="#section-Current practice">Current practice</a><ol> </ol></li><li><a href="#section-Cost to Implementors">Cost to Implementors</a><ol> </ol></li><li><a href="#section-Cost to Users">Cost to Users</a><ol> </ol></li><li><a href="#section-Cost of non-adoption">Cost of non-adoption</a><ol> </ol></li><li><a href="#section-Benefits">Benefits</a><ol> </ol></li><li><a href="#section-Esthetics">Esthetics</a><ol> </ol></li><li><a href="#section-Discussion">Discussion</a><ol> </ol></li></ol></nav><div class="content"><h1>X3J13 Issue DATA-TYPES-HIERARCHY-UNDERSPECIFIED [NIL] [CHANGE]</h1><section id="section-Status" class="status-passed section"><h2 class="section-title">Status</h2>Passed, Aug 88 X3J13 </section><section id="section-References" class="section"><h2 class="section-title">References</h2>CLtL 33-35 (data types) CLtL 312 (<a class="macro-reference" href="../chapter-8.xhtml#macro-defstruct">defstruct</a> :INCLUDE option) </section><section id="section-Edit history" class="section"><h2 class="section-title">Edit history</h2>24-Mar-88, version 1 by Steele 4-Sep-88, version 2 by X3J13 June 88 </section><section id="section-Problem description" class="section"><h2 class="section-title">Problem description</h2>The types <a class="type-reference" href="../chapter-18.xhtml#type-hash-table">hash-table</a>, <a class="type-reference" href="../chapter-23.xhtml#type-readtable">readtable</a>, <a class="type-reference" href="../chapter-11.xhtml#type-package">package</a>, <a class="function-reference" href="../chapter-19.xhtml#function-pathname">pathname</a>, <a class="type-reference" href="../chapter-21.xhtml#type-stream">stream</a>, and <a class="type-reference" href="../chapter-12.xhtml#type-random-state">random-state</a> currently are not required to be disjoint from <a class="function-reference" href="../chapter-14.xhtml#function-cons">cons</a>, <a class="symbol-reference" href="../chapter-2.xhtml#symbol-symbol">symbol</a>, <a class="symbol-reference" href="../chapter-2.xhtml#symbol-array">array</a>, <a class="type-reference" href="../chapter-12.xhtml#type-number">number</a>, or <a class="function-reference" href="../chapter-13.xhtml#function-character">character</a>.  The same is true of <a class="macro-reference" href="../chapter-8.xhtml#macro-defstruct">defstruct</a> types.  With the arrival of CLOS, lack of disjointness will be inconvenient because one cannot reliably use generic function dispatch on these types. <br/></section><section class="status-passed proposal" id="issue-data-types-hierarchy-underspecified:disjoint"><h2 class="section-title">Proposal DISJOINT</h2>Remove the third and antepenultimate bulleted items from section 2.15 is CLtL and replace with the following: <br/>  * The types <a class="function-reference" href="../chapter-14.xhtml#function-cons">cons</a>, <a class="symbol-reference" href="../chapter-2.xhtml#symbol-symbol">symbol</a>, <a class="symbol-reference" href="../chapter-2.xhtml#symbol-array">array</a>, <a class="type-reference" href="../chapter-12.xhtml#type-number">number</a>, <a class="function-reference" href="../chapter-13.xhtml#function-character">character</a>, <a class="type-reference" href="../chapter-18.xhtml#type-hash-table">hash-table</a>, <a class="type-reference" href="../chapter-23.xhtml#type-readtable">readtable</a>,   <a class="type-reference" href="../chapter-11.xhtml#type-package">package</a>, <a class="function-reference" href="../chapter-19.xhtml#function-pathname">pathname</a>, <a class="type-reference" href="../chapter-21.xhtml#type-stream">stream</a>, <a class="type-reference" href="../chapter-12.xhtml#type-random-state">random-state</a>, and any single other type created   by <a class="macro-reference" href="../chapter-8.xhtml#macro-defstruct">defstruct</a> [or <a class="macro-reference" href="../chapter-7.xhtml#macro-defclass">defclass</a>] are pairwise disjoint. <br/>Also, in the discussion of the <a class="macro-reference" href="../chapter-8.xhtml#macro-defstruct">defstruct</a> :INCLUDE option, it is an error for the type given to the :INCLUDE option to be <a class="function-reference" href="../chapter-14.xhtml#function-cons">cons</a>, <a class="symbol-reference" href="../chapter-2.xhtml#symbol-symbol">symbol</a>, <a class="symbol-reference" href="../chapter-2.xhtml#symbol-array">array</a>, <a class="type-reference" href="../chapter-12.xhtml#type-number">number</a>, <a class="function-reference" href="../chapter-13.xhtml#function-character">character</a>, <a class="type-reference" href="../chapter-18.xhtml#type-hash-table">hash-table</a>, <a class="type-reference" href="../chapter-23.xhtml#type-readtable">readtable</a>, <a class="type-reference" href="../chapter-11.xhtml#type-package">package</a>, <a class="function-reference" href="../chapter-19.xhtml#function-pathname">pathname</a>, <a class="type-reference" href="../chapter-21.xhtml#type-stream">stream</a>, or <a class="type-reference" href="../chapter-12.xhtml#type-random-state">random-state</a>. <br/></section><section id="section-Rationale" class="section"><h2 class="section-title">Rationale</h2>It would be useful to extend sequence functions to operate on streams or hash tables, for example, through the CLOS generic function mechanism. This is not possible under the current specification. <br/></section><section id="section-Current practice" class="section"><h2 class="section-title">Current practice</h2>Some implementations in effect use <a class="macro-reference" href="../chapter-8.xhtml#macro-defstruct">defstruct</a> to define data structures such as hash tables and random-states. <br/></section><section id="section-Cost to Implementors" class="section"><h2 class="section-title">Cost to Implementors</h2>Small or nonexistent.  The main reason this disjointness was not specified in CLtL was the possibility that structures might not be easily distinguishable: a stupid concern over a slight efficiency.  This implementation freedom apparently has not been exploited in practice. <br/></section><section id="section-Cost to Users" class="section"><h2 class="section-title">Cost to Users</h2>None. <br/></section><section id="section-Cost of non-adoption" class="section"><h2 class="section-title">Cost of non-adoption</h2>CLOS will be less useful. <br/></section><section id="section-Benefits" class="section"><h2 class="section-title">Benefits</h2>CLOS will be more useful. <br/></section><section id="section-Esthetics" class="section"><h2 class="section-title">Esthetics</h2>This makes the type system simpler and easier to understand. <br/></section><section id="section-Discussion" class="section"><h2 class="section-title">Discussion</h2>This suggestion originated in the CLOS committee. </section></div></main><footer>Copyright © 2021 Jan Moringen</footer></body></html>