<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
  "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><link rel="stylesheet" type="text/css" href="../style.css"/><script src="../permalink.js"/><script src="../navigation.js"/><title>Well-specified Common Lisp — FORMAT-E-EXPONENT-SIGN</title></head><body><main><nav class="sidebar"><span class="name">Entry Points</span><br/><ol><li><a href="../chap-0.xhtml#section-Figures">Table of Contents</a></li><li><a href="../symbol-index.xhtml#section-SymbolIndex">Symbol Index</a></li><li><a href="../figure-index.xhtml#section-FigureIndex">Figure Index</a></li><li><a href="../issue-index.xhtml#section-IssueIndices">Issue Index</a></li><li><a href="../note-indices.xhtml#section-ReviewerNoteIndex">Note Indices</a></li><li><a href="../chapter-26.xhtml#section-Glossary">Glossary</a></li></ol><hr/><span class="name">FORMAT-E-EXPONENT-SIGN</span><br/><ol class="local-toc"><li><a href="#section-Status">Status</a><ol> </ol></li><li><a href="#section-References">References</a><ol> </ol></li><li><a href="#section-Edit history">Edit history</a><ol> </ol></li><li><a href="#section-Problem description">Problem description</a><ol> </ol></li><li><a href="#issue-format-e-exponent-sign:force-sign">Proposal FORCE-SIGN</a><ol> </ol></li><li><a href="#section-Test Case">Test Case</a><ol> </ol></li><li><a href="#section-Rationale">Rationale</a><ol> </ol></li><li><a href="#section-Current practice">Current practice</a><ol> </ol></li><li><a href="#section-Adoption Cost">Adoption Cost</a><ol> </ol></li><li><a href="#section-Cost of non-adoption">Cost of non-adoption</a><ol> </ol></li><li><a href="#section-Benefits">Benefits</a><ol> </ol></li><li><a href="#section-Conversion Cost">Conversion Cost</a><ol> </ol></li><li><a href="#section-Esthetics">Esthetics</a><ol> </ol></li><li><a href="#section-Discussion">Discussion</a><ol> </ol></li></ol></nav><div class="content"><h1>X3J13 Issue FORMAT-E-EXPONENT-SIGN [Cleanup] [CLARIFICATION]</h1><section id="section-Status" class="status-passed section"><h2 class="section-title">Status</h2>Passed, Jan 89 X3J13 </section><section id="section-References" class="section"><h2 class="section-title">References</h2>CLtL pp. 366, 393 </section><section id="section-Edit history" class="section"><h2 class="section-title">Edit history</h2>Bob Cassels, 13 Sep 88 Masinter,  2-Oct-88 (change issue name) </section><section id="section-Problem description" class="section"><h2 class="section-title">Problem description</h2>    The result of <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-22.xhtml#function-format">format</a> <a class="section-reference" href="../chapter-1.xhtml#section-NIL">nil</a> <span class="syntax-string">"~E"</span> <span class="syntax-number">1.0</span>)</span>
</span></code> is specified in a contradictory way.     The ambiguity is whether a plus sign should be printed in front of     the exponent. <br/>    The top of page 393 says, "Next, either a plus or a minus sign is     printed, followed by e digits ... [decimal exponent]" <br/>    Later on page 393 we see, "If all of w, d, and e are omitted, then the     effect is ... [like prin1]. <br/>    Page 366 [presumably where prin1 is defined] doesn't explicitly say that     the plus sign is omitted from the exponent, but all the examples <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="macro-reference" href="../chapter-5.xhtml#macro-and">and</a>
    <span class="syntax-interned-symbol">usual</span> <span class="syntax-interned-symbol">practice</span>)</span>
</span></code></pre> indicate that. <br/>    So the posssibilities are: <br/>	A. "1.0e+0" 	B. "1.0e0" <br/>    The first reference implies that A is correct, the third reference     implies that B is correct.  The second reference implies that A and B     are the same. <br/></section><section class="status-passed proposal" id="issue-format-e-exponent-sign:force-sign"><h2 class="section-title">Proposal FORCE-SIGN</h2>    Specify that ~E always prints a plus or minus sign in front of the     exponent. <br/> This would cause the language on page 393 of CLtL to to change: <br/>    "If all of w, d, and e are omitted, then the effect is to print the     value using ordinary free-format exponential-notation output; <a class="function-reference" href="../chapter-22.xhtml#function-prin1">PRIN1</a> uses     a similar format for any non-zero number whose magnitude is less than     10**-3 or greater than or equal to 10**7.  The only difference is that     the ~E directive always prints a plus or minus sign in front of the     exponent, while <a class="function-reference" href="../chapter-22.xhtml#function-prin1">PRIN1</a> omits the plus sign if the exponent is     non-negative." <br/></section><section id="section-Test Case" class="section"><h2 class="section-title">Test Case</h2><pre>    <code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-22.xhtml#function-format">format</a> <a class="section-reference" href="../chapter-1.xhtml#section-NIL">nil</a> <span class="syntax-string">"~E"</span> <span class="syntax-number">1.0</span>)</span>
</span></code> <a class="function-reference" href="../chapter-12.xhtml#function-=">=</a>&gt; "1.0e+0"<br/><br/></pre></section><section id="section-Rationale" class="section"><h2 class="section-title">Rationale</h2>    This proposal makes ~E self-consistent.  That is more important than     making ~E consistent with <a class="function-reference" href="../chapter-22.xhtml#function-prin1">PRIN1</a>. <br/></section><section id="section-Current practice" class="section"><h2 class="section-title">Current practice</h2>    Symbolics Common Lisp, Ibuki Lisp, and VAX Lisp all print the plus     sign as in the test case above.  Apollo DOMAIN Common Lisp <pre><code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">version</span>
    <span class="syntax-number">2.10</span>)</span>
</span></code></pre> and Xerox Common Lisp produce "1.0", which is wrong because      it includes no exponent at all. <br/></section><section id="section-Adoption Cost" class="section"><h2 class="section-title">Adoption Cost</h2>    Minimal changes to one printing routine for non-conforming     implementations.  (No change to the three implementations mentioned     above.) <br/></section><section id="section-Cost of non-adoption" class="section"><h2 class="section-title">Cost of non-adoption</h2>    Minor confusion and possible incompatibility among implementations. <br/></section><section id="section-Benefits" class="section"><h2 class="section-title">Benefits</h2>    Less confusion, more compatibility. <br/></section><section id="section-Conversion Cost" class="section"><h2 class="section-title">Conversion Cost</h2>    Minimal.  It is doubtful that any user programs depend on this     obscure distinction. <br/></section><section id="section-Esthetics" class="section"><h2 class="section-title">Esthetics</h2>    A matter of opinion. <br/></section><section id="section-Discussion" class="section"><h2 class="section-title">Discussion</h2>    Fortran ~E format requires a sign before the exponent, since the exponent     mark character may be dropped.  Since Common Lisp ~E always prints     the exponent marker, the exponent sign may be dropped in the case     that it would be a plus sign. <br/></section></div></main><footer>Copyright © 2021 Jan Moringen</footer></body></html>