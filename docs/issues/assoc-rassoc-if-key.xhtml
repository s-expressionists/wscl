<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
  "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><link rel="stylesheet" type="text/css" href="../style.css"/><script src="../permalink.js"/><script src="../navigation.js"/><title>Well-specified Common Lisp — ASSOC-RASSOC-IF-KEY</title></head><body><main><nav class="sidebar"><span class="name">Entry Points</span><br/><ol><li><a href="../chap-0.xhtml#section-Figures">Table of Contents</a></li><li><a href="../symbol-index.xhtml#section-SymbolIndex">Symbol Index</a></li><li><a href="../figure-index.xhtml#section-FigureIndex">Figure Index</a></li><li><a href="../issue-index.xhtml#section-IssueIndices">Issue Index</a></li><li><a href="../note-indices.xhtml#section-ReviewerNoteIndex">Note Indices</a></li><li><a href="../chapter-26.xhtml#section-Glossary">Glossary</a></li></ol><hr/><span class="name">ASSOC-RASSOC-IF-KEY</span><br/><ol class="local-toc"><li><a href="#section-Status">Status</a><ol> </ol></li><li><a href="#section-References">References</a><ol> </ol></li><li><a href="#section-Edit history">Edit history</a><ol> </ol></li><li><a href="#section-Problem Description">Problem Description</a><ol> </ol></li><li><a href="#issue-assoc-rassoc-if-key:yes">Proposal YES</a><ol> </ol></li><li><a href="#section-Example">Example</a><ol> </ol></li><li><a href="#section-Rationale">Rationale</a><ol> </ol></li><li><a href="#section-Current Practice">Current Practice</a><ol> </ol></li><li><a href="#section-Cost to Common Lisp implementors">Cost to Common Lisp implementors</a><ol> </ol></li><li><a href="#section-Benefits">Benefits</a><ol> </ol></li><li><a href="#section-Aesthetics">Aesthetics</a><ol> </ol></li><li><a href="#section-Discussion">Discussion</a><ol> </ol></li></ol></nav><div class="content"><h1>X3J13 Issue ASSOC-RASSOC-IF-KEY [NIL] [ENHANCEMENT]</h1><section id="section-Status" class="status-passed section"><h2 class="section-title">Status</h2>passed, 1988 (not sure which meeting) </section><section id="section-References" class="section"><h2 class="section-title">References</h2><a class="function-reference" href="../chapter-14.xhtml#function-assoc-if">ASSOC-IF</a> (p280), <a class="function-reference" href="../chapter-14.xhtml#function-assoc-if-not">ASSOC-IF-NOT</a> (p280), <a class="function-reference" href="../chapter-14.xhtml#function-rassoc-if">RASSOC-IF</a> (p281), <a class="function-reference" href="../chapter-14.xhtml#function-rassoc-if-not">RASSOC-IF-NOT</a> (p281) </section><section id="section-Edit history" class="section"><h2 class="section-title">Edit history</h2>22-Apr-87, Version 1 by Pitman 20-Nov-87, Versions 2,3 by Masinter 23-Nov-87, Version 4 by Masinter </section><section id="section-Problem Description" class="section"><h2 class="section-title">Problem Description</h2>The descriptions of <a class="function-reference" href="../chapter-14.xhtml#function-assoc-if">ASSOC-IF</a>, <a class="function-reference" href="../chapter-14.xhtml#function-assoc-if-not">ASSOC-IF-NOT</a>, <a class="function-reference" href="../chapter-14.xhtml#function-rassoc-if">RASSOC-IF</a>, and <a class="function-reference" href="../chapter-14.xhtml#function-rassoc-if-not">RASSOC-IF-NOT</a> do not mention a :KEY option, although <a class="function-reference" href="../chapter-14.xhtml#function-assoc">ASSOC</a> and <a class="function-reference" href="../chapter-14.xhtml#function-rassoc">RASSOC</a> have one.  <br/>This is often reported as an inconsistency in Common Lisp. <br/></section><section class="status-passed proposal" id="issue-assoc-rassoc-if-key:yes"><h2 class="section-title">Proposal YES</h2>Allow a :KEY keyword for <a class="function-reference" href="../chapter-14.xhtml#function-assoc-if">ASSOC-IF</a>, <a class="function-reference" href="../chapter-14.xhtml#function-assoc-if-not">ASSOC-IF-NOT</a>, <a class="function-reference" href="../chapter-14.xhtml#function-rassoc-if">RASSOC-IF</a>, and <a class="function-reference" href="../chapter-14.xhtml#function-rassoc-if-not">RASSOC-IF-NOT</a>. If not supplied, it should default to #'<a class="function-reference" href="../chapter-5.xhtml#function-identity">IDENTITY</a> as do the :KEY keywords for other -IF and -IF-NOT functions. The function, as with the :KEY argument for <a class="function-reference" href="../chapter-14.xhtml#function-assoc">ASSOC</a> and <a class="function-reference" href="../chapter-14.xhtml#function-rassoc">RASSOC</a>, is applied to the <a class="function-reference" href="../chapter-14.xhtml#function-car">CAR</a> of the pair in the association list for <a class="function-reference" href="../chapter-14.xhtml#function-assoc-if">ASSOC-IF</a> and <a class="function-reference" href="../chapter-14.xhtml#function-assoc-if-not">ASSOC-IF-NOT</a> and the <a class="function-reference" href="../chapter-14.xhtml#function-cdr">CDR</a> of the pair for <a class="function-reference" href="../chapter-14.xhtml#function-rassoc-if">RASSOC-IF</a> and <a class="function-reference" href="../chapter-14.xhtml#function-rassoc-if-not">RASSOC-IF-NOT</a>. <br/>Documentation impact: <br/>A better description of the intent might be to say that the car /contains<a class="function-reference" href="../chapter-12.xhtml#function-/">/</a> the key of the association, and by default the car /is<a class="function-reference" href="../chapter-12.xhtml#function-/">/</a> the key of the association. <br/></section><section id="section-Example" class="section"><h2 class="section-title">Example</h2><pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-assoc-if">assoc-if</a> <span class="syntax-function">#'<a class="function-reference" href="../chapter-12.xhtml#function-zerop">zerop</a></span> <span class="syntax-interned-symbol">pathnames</span> <span class="syntax-keyword-symbol">:key</span> <span class="syntax-function">#'<a class="function-reference" href="../chapter-19.xhtml#function-pathname-version">pathname-version</a></span>)</span>
</span></code><br/><br/>could be used to search a list indexed by pathnames finding one with zero version. <br/><br/></pre></section><section id="section-Rationale" class="section"><h2 class="section-title">Rationale</h2>This is an inconsistency in the language that is simple to fix. <br/></section><section id="section-Current Practice" class="section"><h2 class="section-title">Current Practice</h2>Symbolics implements :KEY for the -IF and -IF-NOT assoc functions. Others follow the book and allow :KEY only for <a class="function-reference" href="../chapter-14.xhtml#function-assoc">ASSOC</a>. <br/></section><section id="section-Cost to Common Lisp implementors" class="section"><h2 class="section-title">Cost to Common Lisp implementors</h2>A small amount of additional code is necessary to support this in implementations not already offering it as an extension. <br/>Cost to Common Lisp users: <br/>The change is essentially upward compatible with user code. <br/></section><section id="section-Benefits" class="section"><h2 class="section-title">Benefits</h2>This would make the set of -IF and -IF-NOT functions be more regular in their calling conventions. <br/></section><section id="section-Aesthetics" class="section"><h2 class="section-title">Aesthetics</h2>All the other -IF and -IF-NOT variations of list operations omit the :TEST and :TEST-NOT keywords, but allow :KEY. For example, consider the family of <a class="function-reference" href="../chapter-14.xhtml#function-member">MEMBER</a>, <a class="function-reference" href="../chapter-14.xhtml#function-member-if">MEMBER-IF</a>, and <a class="function-reference" href="../chapter-14.xhtml#function-member-if-not">MEMBER-IF-NOT</a>. Although this introduces additional mechanism, it does so in a way that probably makes it easier to think about which functions do what, so it would likely be seen as a simplification. <br/></section><section id="section-Discussion" class="section"><h2 class="section-title">Discussion</h2>The omission of :KEY in this situation in CLtL was probably an oversight. <br/>The cleanup committee supports this proposal. <br/></section></div></main><footer>Copyright © 2021 Jan Moringen</footer></body></html>