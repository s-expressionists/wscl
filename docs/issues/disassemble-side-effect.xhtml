<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
  "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><link rel="stylesheet" type="text/css" href="../style.css"/><script src="../permalink.js"/><script src="../navigation.js"/><title>Well-specified Common Lisp — DISASSEMBLE-SIDE-EFFECT</title></head><body><main><nav class="sidebar"><span class="name">Entry Points</span><br/><ol><li><a href="../chap-0.xhtml#section-Figures">Table of Contents</a></li><li><a href="../symbol-index.xhtml#section-SymbolIndex">Symbol Index</a></li><li><a href="../figure-index.xhtml#section-FigureIndex">Figure Index</a></li><li><a href="../issue-index.xhtml#section-IssueIndices">Issue Index</a></li><li><a href="../note-indices.xhtml#section-ReviewerNoteIndex">Note Indices</a></li><li><a href="../chapter-26.xhtml#section-Glossary">Glossary</a></li></ol><hr/><span class="name">DISASSEMBLE-SIDE-EFFECT</span><br/><ol class="local-toc"><li><a href="#section-References">References</a><ol> </ol></li><li><a href="#section-Edit history">Edit history</a><ol> </ol></li><li><a href="#section-Status">Status</a><ol> </ol></li><li><a href="#section-Problem description">Problem description</a><ol> </ol></li><li><a href="#issue-disassemble-side-effect:do-not-install">Proposal DO-NOT-INSTALL</a><ol> </ol></li><li><a href="#section-Test Cases/Examples">Test Cases/Examples</a><ol> </ol></li><li><a href="#section-Rationale">Rationale</a><ol> </ol></li><li><a href="#section-Current practice">Current practice</a><ol> </ol></li><li><a href="#section-Cost to Implementors">Cost to Implementors</a><ol> </ol></li><li><a href="#section-Cost to Users">Cost to Users</a><ol> </ol></li><li><a href="#section-Cost of non-Adoption">Cost of non-Adoption</a><ol> </ol></li><li><a href="#section-Benefits">Benefits</a><ol> </ol></li><li><a href="#section-Aesthetics">Aesthetics</a><ol> </ol></li><li><a href="#section-Discussion">Discussion</a><ol> </ol></li></ol></nav><div class="content"><h1>X3J13 Issue DISASSEMBLE-SIDE-EFFECT [NIL] [CLARIFICATION]</h1><section id="section-References" class="section"><h2 class="section-title">References</h2><a class="function-reference" href="../chapter-25.xhtml#function-disassemble">disassemble</a> (p. 439), <a class="function-reference" href="../chapter-3.xhtml#function-compile">compile</a> (p. 439) </section><section id="section-Edit history" class="section"><h2 class="section-title">Edit history</h2>Version 2 by Pierson 12/30/87 Version 3 by Pierson  1/21/88 Version 4 by Pierson  6/10/88 correct VAX Lisp practice </section><section id="section-Status" class="status-unknown section"><h2 class="section-title">Status</h2>Ready For Release? </section><section id="section-Problem description" class="section"><h2 class="section-title">Problem description</h2>The definition of <a class="function-reference" href="../chapter-25.xhtml#function-disassemble">disassemble</a> says that "if the relevant function is not a compiled function, it is first compiled.".  The definition of <a class="function-reference" href="../chapter-3.xhtml#function-compile">compile</a> says that "If name is a <a class="glossary-reference" href="../chapter-26.xhtml#glossary-non-nil">non-nil</a> symbol, then the <a class="type-reference" href="../chapter-4.xhtml#type-compiled-function">compiled-function</a> is installed as the global function definition of the symbol...".  Several implementations have taken this to mean that if <a class="function-reference" href="../chapter-25.xhtml#function-disassemble">disassemble</a> is passed a symbol which has an uncompiled function definition, then it has the side-effect of <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-3.xhtml#function-compile">compile</a> <span class="syntax-quote">'<a class="symbol-reference" href="../chapter-2.xhtml#symbol-symbol">symbol</a></span>)</span>
</span></code></pre>. <br/></section><section class="status-unknown proposal" id="issue-disassemble-side-effect:do-not-install"><h2 class="section-title">Proposal DO-NOT-INSTALL</h2>Clarify that when <a class="function-reference" href="../chapter-25.xhtml#function-disassemble">disassemble</a> compiles a function, it will never install the newly compiled function. <br/></section><section id="section-Test Cases/Examples" class="section"><h2 class="section-title">Test Cases/Examples</h2><pre>    <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="macro-reference" href="../chapter-5.xhtml#macro-defun">defun</a> <span class="syntax-interned-symbol">F</span> <span class="syntax-cons">(<span class="syntax-interned-symbol">A</span>)</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-12.xhtml#function-1+">1+</a> <span class="syntax-interned-symbol">A</span>)</span>)</span>
</span></code></pre><br/>    <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-5.xhtml#function-eq">eq</a> <span class="syntax-cons">(<a class="function-reference" href="../chapter-10.xhtml#function-symbol-function">symbol-function</a> <span class="syntax-quote">'<span class="syntax-interned-symbol">F</span></span>)</span>
	<span class="syntax-cons">(<a class="special-operator-reference" href="../chapter-5.xhtml#special-operator-progn">progn</a> <span class="syntax-cons">(<a class="function-reference" href="../chapter-25.xhtml#function-disassemble">disassemble</a> <span class="syntax-quote">'<span class="syntax-interned-symbol">F</span></span>)</span>
	       <span class="syntax-cons">(<a class="function-reference" href="../chapter-10.xhtml#function-symbol-function">symbol-function</a> <span class="syntax-quote">'<span class="syntax-interned-symbol">F</span></span>)</span>)</span>)</span>
</span></code></pre><br/><br/>This code will return <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a> if this proposal is adopted.  Some current<br/>implementations will return <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a>, some will return <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a>.<br/><br/></pre></section><section id="section-Rationale" class="section"><h2 class="section-title">Rationale</h2>Several current implementations of <a class="function-reference" href="../chapter-25.xhtml#function-disassemble">disassemble</a> have surprising side effects, especially for new users. <br/></section><section id="section-Current practice" class="section"><h2 class="section-title">Current practice</h2>Allegro <a class="package-reference" href="../chapter-11.xhtml#package-cl">cl</a> installs the compiled definition.  Lucid, Symbolics, Xerox, VAX Lisp, and KCL don't install it. <br/></section><section id="section-Cost to Implementors" class="section"><h2 class="section-title">Cost to Implementors</h2>Some implementations will have to make a simple change. <br/></section><section id="section-Cost to Users" class="section"><h2 class="section-title">Cost to Users</h2>Very little.  <a class="function-reference" href="../chapter-25.xhtml#function-disassemble">disassemble</a> is really part of the environment and is probably not called by much, if any user code. <br/></section><section id="section-Cost of non-Adoption" class="section"><h2 class="section-title">Cost of non-Adoption</h2><a class="function-reference" href="../chapter-25.xhtml#function-disassemble">disassemble</a> will continue to surprise less experienced users. <br/></section><section id="section-Benefits" class="section"><h2 class="section-title">Benefits</h2><a class="function-reference" href="../chapter-25.xhtml#function-disassemble">disassemble</a> will become the predictable debugging function it was meant to be. <br/></section><section id="section-Aesthetics" class="section"><h2 class="section-title">Aesthetics</h2>Some who worried that <a class="function-reference" href="../chapter-25.xhtml#function-disassemble">disassemble</a> was supposed to install the compiled function may find that the language has become a little cleaner. <br/></section><section id="section-Discussion" class="section"><h2 class="section-title">Discussion</h2><a class="function-reference" href="../chapter-25.xhtml#function-disassemble">disassemble</a> is an environment feature; some question has been raised as to the place and force of environment features in the standard. However, this proposal stands if <a class="function-reference" href="../chapter-25.xhtml#function-disassemble">disassemble</a> is part of the standard language. <br/></section></div></main><footer>Copyright © 2021 Jan Moringen</footer></body></html>