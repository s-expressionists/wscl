<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
  "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><link rel="stylesheet" type="text/css" href="../style.css"/><script src="../permalink.js"/><script src="../navigation.js"/><title>Well-specified Common Lisp â€” MAP-INTO</title></head><body><main><nav class="sidebar"><span class="name">Entry Points</span><br/><ol><li><a href="../chap-0.xhtml#section-Figures">Table of Contents</a></li><li><a href="../symbol-index.xhtml#section-SymbolIndex">Symbol Index</a></li><li><a href="../figure-index.xhtml#section-FigureIndex">Figure Index</a></li><li><a href="../issue-index.xhtml#section-IssueIndices">Issue Index</a></li><li><a href="../note-indices.xhtml#section-ReviewerNoteIndex">Note Indices</a></li><li><a href="../chapter-26.xhtml#section-Glossary">Glossary</a></li></ol><hr/><span class="name">MAP-INTO</span><br/><ol class="local-toc"><li><a href="#section-Status">Status</a><ol> </ol></li><li><a href="#section-References">References</a><ol> </ol></li><li><a href="#section-Edit history">Edit history</a><ol> </ol></li><li><a href="#section-Problem description">Problem description</a><ol> </ol></li><li><a href="#issue-map-into:add-function">Proposal ADD-FUNCTION</a><ol> </ol></li><li><a href="#section-Examples">Examples</a><ol> </ol></li><li><a href="#section-Rationale">Rationale</a><ol> </ol></li><li><a href="#section-Current practice">Current practice</a><ol> </ol></li><li><a href="#section-Cost to Implementors">Cost to Implementors</a><ol> </ol></li><li><a href="#section-Cost to Users">Cost to Users</a><ol> </ol></li><li><a href="#section-Cost of non-adoption">Cost of non-adoption</a><ol> </ol></li><li><a href="#section-Performance impact">Performance impact</a><ol> </ol></li><li><a href="#section-Benefits">Benefits</a><ol> </ol></li><li><a href="#section-Esthetics">Esthetics</a><ol> </ol></li><li><a href="#section-Discussion">Discussion</a><ol> </ol></li></ol></nav><div class="content"><h1>X3J13 Issue MAP-INTO [NIL] [ADDITION]</h1><h2>Related issues</h2><ul><span class="issue-reference error">issue:BIT-ARRAY-FUNCTIONS</span></ul><section id="section-Status" class="status-passed section"><h2 class="section-title">Status</h2>Passed, Jun 89 X3J13 </section><section id="section-References" class="section"><h2 class="section-title">References</h2>none </section><section id="section-Edit history" class="section"><h2 class="section-title">Edit history</h2>23-May-89, version 1 by Moon 19-Jun-89, version 2 by Moon (fix arglist) 23-Jun-89, version 3 by Moon (include BarMar's suggestions) </section><section id="section-Problem description" class="section"><h2 class="section-title">Problem description</h2>  The function <a class="function-reference" href="../chapter-17.xhtml#function-map">map</a> is very useful but can be a source of inefficiency   because it conses the result.  Sometimes the user has storage   already allocated in which the result could be stored. <br/></section><section class="status-passed proposal" id="issue-map-into:add-function"><h2 class="section-title">Proposal ADD-FUNCTION</h2>  Add the following function: <br/>    <a class="function-reference" href="../chapter-17.xhtml#function-map-into">map-into</a> result-sequence function &amp;rest sequences            [Function] <br/>    Destructively modifies the result-sequence to contain the results of     applying function to each element in the argument sequences in turn.     Returns result-sequence. <br/>    The arguments result-sequence and each element of sequences can each be     either a list or a vector <pre><code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">one-dimensional</span> <a class="symbol-reference" href="../chapter-2.xhtml#symbol-array">array</a>)</span>
</span></code></pre>.  Note that <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a> is     considered to be a sequence, of length zero.  If result-sequence and     each element of sequences are not all the same length, the iteration     terminates when the shortest sequence is exhausted.  If result-sequence     is a vector with a <a class="function-reference" href="../chapter-15.xhtml#function-fill-pointer">fill-pointer</a>, the <a class="function-reference" href="../chapter-15.xhtml#function-fill-pointer">fill-pointer</a> is ignored when     deciding how many iterations to perform, and afterwards the     <a class="function-reference" href="../chapter-15.xhtml#function-fill-pointer">fill-pointer</a> is set to the number of times function was applied. <br/>    If result-sequence is longer than the shortest element of sequences,     extra elements at the end of result-sequence are left unchanged. <br/>    <a class="function-reference" href="../chapter-17.xhtml#function-map-into">map-into</a> differs from <a class="function-reference" href="../chapter-17.xhtml#function-map">map</a> in that it modifies an existing sequence     rather than creating a new one.  In addition, <a class="function-reference" href="../chapter-17.xhtml#function-map-into">map-into</a> can be called     with only two arguments, while <a class="function-reference" href="../chapter-17.xhtml#function-map">map</a> requires at least three arguments.     If result-sequence is <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a>, <a class="function-reference" href="../chapter-17.xhtml#function-map-into">map-into</a> immediately returns <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a>, since     <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a> is a sequence of length zero. <br/>    If <span class="issue-reference error">issue:BIT-ARRAY-FUNCTIONS:NO-NEW-FUNCTIONS</span> passes, then <a class="function-reference" href="../chapter-17.xhtml#function-map-into">map-into</a> will     allow result-sequence and each element of sequences to be mappables     all of the same rank. <br/>    The function must take at least as many arguments as there are     sequences provided. <br/>    If function has side effects, it can count on being called first on all     of the elements with index 0, then on all of those numbered 1, and so     on. <br/></section><section id="section-Examples" class="section"><h2 class="section-title">Examples</h2><pre>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-17.xhtml#function-map-into">map-into</a> <span class="syntax-interned-symbol">x</span> <span class="syntax-function">#'<a class="function-reference" href="../chapter-12.xhtml#function-+">+</a></span> <span class="syntax-interned-symbol">x</span> <span class="syntax-interned-symbol">y</span>)</span>
</span></code></pre><br/>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-17.xhtml#function-map-into">map-into</a> <span class="syntax-interned-symbol">q</span> <span class="syntax-function">#'<a class="function-reference" href="../chapter-14.xhtml#function-cons">cons</a></span> <span class="syntax-interned-symbol">keys</span> <span class="syntax-interned-symbol">vals</span>)</span>
</span></code></pre><br/>  <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-17.xhtml#function-map-into">map-into</a> <span class="syntax-interned-symbol">syms</span> <span class="syntax-function">#'<a class="function-reference" href="../chapter-10.xhtml#function-gensym">gensym</a></span>)</span>
</span></code></pre><br/><br/></pre></section><section id="section-Rationale" class="section"><h2 class="section-title">Rationale</h2>  <a class="function-reference" href="../chapter-17.xhtml#function-map-into">map-into</a> is a simple way to express reuse of storage that is   stylistically consistent with the rest of Common Lisp. <br/></section><section id="section-Current practice" class="section"><h2 class="section-title">Current practice</h2>  Symbolics Genera 7.2 implements the proposal. <br/></section><section id="section-Cost to Implementors" class="section"><h2 class="section-title">Cost to Implementors</h2>  Small. <br/></section><section id="section-Cost to Users" class="section"><h2 class="section-title">Cost to Users</h2>  None. <br/></section><section id="section-Cost of non-adoption" class="section"><h2 class="section-title">Cost of non-adoption</h2>  Small. <br/></section><section id="section-Performance impact" class="section"><h2 class="section-title">Performance impact</h2>  None. <br/></section><section id="section-Benefits" class="section"><h2 class="section-title">Benefits</h2>  More expressive language. <br/></section><section id="section-Esthetics" class="section"><h2 class="section-title">Esthetics</h2>  User programs won't have to write the above examples as <br/>   <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="macro-reference" href="../chapter-6.xhtml#macro-loop">loop</a> <span class="syntax-interned-symbol">for</span> <span class="syntax-interned-symbol">xx</span> <span class="syntax-interned-symbol">on</span> <span class="syntax-interned-symbol">x</span> <a class="macro-reference" href="../chapter-5.xhtml#macro-and">and</a> <span class="syntax-interned-symbol">yy</span> <span class="syntax-interned-symbol">in</span> <span class="syntax-interned-symbol">y</span> <a class="macro-reference" href="../chapter-6.xhtml#macro-do">do</a>
      <span class="syntax-cons">(<a class="macro-reference" href="../chapter-5.xhtml#macro-setf">setf</a> <span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-car">car</a> <span class="syntax-interned-symbol">xx</span>)</span> <span class="syntax-cons">(<a class="function-reference" href="../chapter-12.xhtml#function-+">+</a> <span class="syntax-cons">(<a class="function-reference" href="../chapter-14.xhtml#function-car">car</a> <span class="syntax-interned-symbol">xx</span>)</span> <span class="syntax-interned-symbol">yy</span>)</span>)</span>)</span>
</span></code></pre> <br/>  or something else about equally horrible. <br/></section><section id="section-Discussion" class="section"><h2 class="section-title">Discussion</h2>  None. </section></div></main><footer>Copyright Â© 2021 Jan Moringen</footer></body></html>