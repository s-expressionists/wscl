<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
  "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><link rel="stylesheet" type="text/css" href="../style.css"/><script src="../permalink.js"/><script src="../navigation.js"/><title>Well-specified Common Lisp — DESCRIBE-UNDERSPECIFIED</title></head><body><main><nav class="sidebar"><span class="name">Entry Points</span><br/><ol><li><a href="../chap-0.xhtml#section-Figures">Table of Contents</a></li><li><a href="../symbol-index.xhtml#section-SymbolIndex">Symbol Index</a></li><li><a href="../figure-index.xhtml#section-FigureIndex">Figure Index</a></li><li><a href="../issue-index.xhtml#section-IssueIndices">Issue Index</a></li><li><a href="../note-indices.xhtml#section-ReviewerNoteIndex">Note Indices</a></li><li><a href="../chapter-26.xhtml#section-Glossary">Glossary</a></li></ol><hr/><span class="name">DESCRIBE-UNDERSPECIFIED</span><br/><ol class="local-toc"><li><a href="#section-Status">Status</a><ol> </ol></li><li><a href="#section-References">References</a><ol> </ol></li><li><a href="#section-Edit history">Edit history</a><ol> </ol></li><li><a href="#section-Problem description">Problem description</a><ol> </ol></li><li><a href="#issue-describe-underspecified:describe-object">Proposal DESCRIBE-OBJECT</a><ol> </ol></li><li><a href="#section-Rationale">Rationale</a><ol> </ol></li><li><a href="#section-Current practice">Current practice</a><ol> </ol></li><li><a href="#section-Cost to Implementors">Cost to Implementors</a><ol> </ol></li><li><a href="#section-Cost to Users">Cost to Users</a><ol> </ol></li><li><a href="#section-Cost of non-adoption">Cost of non-adoption</a><ol> </ol></li><li><a href="#section-Benefits">Benefits</a><ol> </ol></li><li><a href="#section-Aesthetics">Aesthetics</a><ol> </ol></li><li><a href="#section-Discussion">Discussion</a><ol> </ol></li></ol></nav><div class="content"><h1>X3J13 Issue DESCRIBE-UNDERSPECIFIED [Cleanup] [CHANGE, ADDITION]</h1><section id="section-Status" class="status-passed section"><h2 class="section-title">Status</h2>Passed, as amended, Mar 89 X3J13 </section><section id="section-References" class="section"><h2 class="section-title">References</h2>CLtL p441-2 88-002R, <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a> function </section><section id="section-Edit history" class="section"><h2 class="section-title">Edit history</h2>Version 1, 10-Mar-89, Kim A. Barrett Version 2,  9-Apr-89, Masinter (as per Mar 89 X3J13) </section><section id="section-Problem description" class="section"><h2 class="section-title">Problem description</h2> The CLOS Specification (X3J13 Document 88-002R) changes the definition of the  function <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a>, making it a generic function.  However, it does not specify  any of the protocol needed to make user-defined methods interact properly to  produce some of the effects mentioned in CLtL.  For example, CLtL says that  sometimes the method for describing an object will involve describing  something that it finds inside the object, and that such recursive  descriptions are indented appropriately.  How do user-written methods achieve  this indentation?  Must they arrange for the indentation explicitly, or is  there some automatic mechanism that handles it? <br/> The new specification does not easily lend itself to certain kinds of features  which some implementations have included in their versions of <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a>, such  as analogues to the printer's depth limits <pre><code><span class="syntax-root"><span class="syntax-cons">(<span class="syntax-interned-symbol">*PRINT-DEPTH*</span>)</span>
</span></code></pre> and circular  structure detection during recursion <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="symbol-reference" href="../chapter-2.xhtml#symbol-*print-circle*">*print-circle*</a>)</span>
</span></code></pre>. <br/> In addition, <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a> does not take a stream argument, instead always doing  output to <a class="variable-reference" href="../chapter-21.xhtml#variable-*standard-output*">*standard-output*</a>.  This means that a program which wants to use  <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a> to output some information to a particular stream must rebind  <a class="variable-reference" href="../chapter-21.xhtml#variable-*standard-output*">*standard-output*</a> around the call to <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a>.  This is a nuisance, and is  also potentially a bad idea in implementations which have interrupts and such. <br/></section><section class="status-passed proposal" id="issue-describe-underspecified:describe-object"><h2 class="section-title">Proposal DESCRIBE-OBJECT</h2> Remove the section of 88-002R which specifies that <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a> is a generic  function.  Modify <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a> to accept an optional second stream argument, which  defaults to <a class="variable-reference" href="../chapter-21.xhtml#variable-*standard-output*">*standard-output*</a>, and which is handled in the same way as the  stream argument to <a class="function-reference" href="../chapter-22.xhtml#function-print">print</a> (that is, permitting arguments of <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a> and <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a>).  The value of this argument is the stream which output will be directed to.   Specify that <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a> is implemented in terms of the generic function  <a class="function-reference" href="../chapter-25.xhtml#function-describe-object">describe-object</a>, described below. <br/> <a class="function-reference" href="../chapter-25.xhtml#function-describe-object">describe-object</a> object stream				[Generic Function] <br/>  The generic function <a class="function-reference" href="../chapter-25.xhtml#function-describe-object">describe-object</a> writes a description of an object to a   stream.  The function <a class="function-reference" href="../chapter-25.xhtml#function-describe-object">describe-object</a> is called by the <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a> function; it   should not be called by the user. <br/>  Each implementation is required to provide a method on the class   <a class="type-reference" href="../chapter-4.xhtml#type-standard-object">standard-object</a> and methods on enough other classes so as to ensure that   there is always an applicable method.  Implementations are free to add   methods for other classes.  Users can write methods for <a class="function-reference" href="../chapter-25.xhtml#function-describe-object">describe-object</a> for   their own classes if they do not wish to inherit an implementation-supplied   method. <br/>  ARGUMENTS: <br/>   The first argument is any Lisp object.  The second argument is a stream; it    cannot be <a class="section-reference" href="../chapter-26.xhtml#section-T">T</a> or <a class="section-reference" href="../chapter-1.xhtml#section-NIL">NIL</a>. <br/>  <a class="function-reference" href="../chapter-5.xhtml#function-values">values</a>: <br/>   The values returned by <a class="function-reference" href="../chapter-25.xhtml#function-describe-object">describe-object</a> are unspecified. <br/>  REMARKS: <br/>   Methods on <a class="function-reference" href="../chapter-25.xhtml#function-describe-object">describe-object</a> may recursively call <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a>.  Indentation,    depth limits, and circularity detection are all taken care of automatically,    provided that each method handles exactly one level of structure and calls    <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a> recursively if there are more structural levels. <br/>   If this rule is not obeyed, the results are undefined. <br/>   In some implementations the stream argument passed to a <a class="function-reference" href="../chapter-25.xhtml#function-describe-object">describe-object</a>    method is not the original stream, but is an intermediate stream that    implements parts of <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a>.  Methods should therefore not depend on the    identity of this stream. <br/></section><section id="section-Rationale" class="section"><h2 class="section-title">Rationale</h2> This proposal was closely modeled on the CLOS description of <a class="function-reference" href="../chapter-22.xhtml#function-print-object">print-object</a>,  which was well thought out and provides a great deal of functionality and  implementation freedom.  The same implementation techniques applicable to  <a class="function-reference" href="../chapter-22.xhtml#function-print-object">print-object</a> will be applicable to <a class="function-reference" href="../chapter-25.xhtml#function-describe-object">describe-object</a>. <br/> The reason for making the return values for <a class="function-reference" href="../chapter-25.xhtml#function-describe-object">describe-object</a> unspecified is to  avoid forcing users to include explicit <pre><code><span class="syntax-root"><span class="syntax-cons">(<a class="function-reference" href="../chapter-5.xhtml#function-values">values</a>)</span>
</span></code></pre> in all their methods.  <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a> will take care of that. <br/></section><section id="section-Current practice" class="section"><h2 class="section-title">Current practice</h2> Probably nobody does precisely what this proposal suggests. <br/></section><section id="section-Cost to Implementors" class="section"><h2 class="section-title">Cost to Implementors</h2> A fair amount of work may be required, since every method<a class="function-reference" href="../chapter-12.xhtml#function-/">/</a>subfunction of  <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a> in an implementation may need at least some fixing to be in line with  this proposal.  On the other hand, that work may already be needed in order to  conform to 88-002R, and this proposal may make the conversion easier by  simplifying the translation of an existing implementation of <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a>. <br/></section><section id="section-Cost to Users" class="section"><h2 class="section-title">Cost to Users</h2> Any users who are using an implementation which supports the current CLOS  specification of <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a> and have defined their own methods will have to  change them.  CLOS is sufficiently recent that this probably isn't a big  problem. <br/> Those users who have made use of implementation-specific hooks into <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a>  to define their own methods will likely have to change, but that was already  the case. <br/> Users who are currently binding <a class="variable-reference" href="../chapter-21.xhtml#variable-*standard-output*">*standard-output*</a> around calls to <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a> may  wish to change their code. <br/></section><section id="section-Cost of non-adoption" class="section"><h2 class="section-title">Cost of non-adoption</h2> Portable <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a> methods may be difficult to write because the protocol they  must follow is insufficiently specified. <br/></section><section id="section-Benefits" class="section"><h2 class="section-title">Benefits</h2> The constraints on <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a> methods are better specified, making it easier to  write such methods properly. <br/></section><section id="section-Aesthetics" class="section"><h2 class="section-title">Aesthetics</h2> Minimal. <br/></section><section id="section-Discussion" class="section"><h2 class="section-title">Discussion</h2> An additional change which is not included in the present proposal would be to  make the syntax of <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a> and <a class="function-reference" href="../chapter-25.xhtml#function-describe-object">describe-object</a> be <br/>  <a class="function-reference" href="../chapter-25.xhtml#function-describe">describe</a> object &amp;optional stream &amp;key   <a class="function-reference" href="../chapter-25.xhtml#function-describe-object">describe-object</a> object stream &amp;key <br/> allowing implementation-specific extensions to the arguments.  A possible  standard keyword argument is :VERBOSE, which might be used to specify how much  output to produce. <br/> It might be desirable to define some new describe control variables analogous  to the printer control variables, ie. *DESCRIBE-LEVEL* and *DESCRIBE-CIRCLE*,  and possibly *DESCRIBE-LENGTH*. &mdash;&mdash;<a class="function-reference" href="../chapter-12.xhtml#function--">-</a> <br/><br/>     &mdash;&ndash; End Forwarded Messages &mdash;&ndash; <br/><br/>     &mdash;&ndash; End Forwarded Messages &mdash;&ndash; </section></div></main><footer>Copyright © 2021 Jan Moringen</footer></body></html>